require('dotenv').config();
const express = require('express');
const path = require('path');
const axios = require('axios');
const crypto = require('crypto');
const { YooCheckout } = require('@a2seven/yoo-checkout');
const config = require('./config');
const { initializeDatabase, OrdersDB, PurchaseHistoryDB, AdminProductsDB } = require('./database');

const app = express();
const PORT = config.PORT;
const TELEGRAM_BOT_TOKEN = config.TELEGRAM_BOT_TOKEN;
const TELEGRAM_ADMIN_CHAT_ID = config.TELEGRAM_ADMIN_CHAT_ID;

// ðŸ’³ Ð˜ÐÐ˜Ð¦Ð˜ÐÐ›Ð˜Ð—ÐÐ¦Ð˜Ð¯ YOOKASSA
console.log('ðŸ”§ Ð˜Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð®Kassa...');
console.log('Shop ID:', config.YOOKASSA_SHOP_ID ? `${config.YOOKASSA_SHOP_ID.substring(0, 6)}***` : 'ÐÐ• Ð£Ð¡Ð¢ÐÐÐžÐ’Ð›Ð•Ð');
console.log('Secret Key:', config.YOOKASSA_SECRET_KEY ? `${config.YOOKASSA_SECRET_KEY.substring(0, 6)}***` : 'ÐÐ• Ð£Ð¡Ð¢ÐÐÐžÐ’Ð›Ð•Ð');

const checkout = new YooCheckout({
    shopId: config.YOOKASSA_SHOP_ID,
    secretKey: config.YOOKASSA_SECRET_KEY
});

// Ð¥Ñ€Ð°Ð½Ð¸Ð»Ð¸Ñ‰Ðµ Ð·Ð°ÐºÐ°Ð·Ð¾Ð² (Ð² Ð¿Ñ€Ð¾Ð´Ð°ÐºÑˆÐµÐ½Ðµ Ð·Ð°Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ Ð½Ð° Ð±Ð°Ð·Ñƒ Ð´Ð°Ð½Ð½Ñ‹Ñ…)
let orders = new Map();
let orderCounter = 0; // ÐÐ°Ñ‡Ð¸Ð½Ð°ÐµÐ¼ Ñ 0 Ð´Ð»Ñ Ð½Ð¾Ð²Ð¾Ð³Ð¾ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ

// ðŸ”¥ Ð¢ÐÐ™ÐœÐ•Ð Ð« Ð”Ð›Ð¯ ÐÐ’Ð¢ÐžÐœÐÐ¢Ð˜Ð§Ð•Ð¡ÐšÐžÐ™ ÐžÐ¢ÐœÐ•ÐÐ« Ð—ÐÐšÐÐ—ÐžÐ’ (30 Ð¼Ð¸Ð½ÑƒÑ‚)
let orderTimers = new Map();

// ðŸ”§ Ð¥Ð ÐÐÐ˜Ð›Ð˜Ð©Ð• Ð¢ÐžÐ’ÐÐ ÐžÐ’ Ð”Ð›Ð¯ ÐÐ”ÐœÐ˜Ð ÐŸÐÐÐ•Ð›Ð˜
let adminProducts = new Map();

app.use(express.json());

// ðŸ”§ CORS Ð´Ð»Ñ Ð°Ð´Ð¼Ð¸Ð½ Ð¿Ð°Ð½ÐµÐ»Ð¸
app.use((req, res, next) => {
    res.header('Access-Control-Allow-Origin', '*');
    res.header('Access-Control-Allow-Methods', 'GET, POST, PUT, PATCH, DELETE, OPTIONS');
    res.header('Access-Control-Allow-Headers', 'Origin, X-Requested-With, Content-Type, Accept, Authorization, X-Admin-Password');
    
    if (req.method === 'OPTIONS') {
        res.sendStatus(200);
    } else {
        next();
    }
});

// ðŸ—„ï¸ ÐŸÐžÐ›ÐÐ«Ð™ ÐšÐÐ¢ÐÐ›ÐžÐ“ Ð¢ÐžÐ’ÐÐ ÐžÐ’ (Ð²ÑÐµ 49 Ñ‚Ð¾Ð²Ð°Ñ€Ð¾Ð² Ð¸Ð· 8 ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¹)
async function loadFullProductCatalog() {
    return {
        'kolbasy': [
            {
                id: 'chorizo-70',
                name: 'ÐšÐ¾Ð»Ð±Ð°ÑÐ° Ð¸Ð· ÑÑ‹Ñ€Ð¾Ð²ÑÐ»ÐµÐ½Ð°Ñ Ð¾Ð»ÐµÐ½Ð¸Ð½Ñ‹ "Ð§Ð¾Ñ€Ð¸Ð·Ð¾"',
                price: 395,
                unit: '/70 Ð³Ñ€.',
                maxQty: 20,
                image: 'ðŸŒ­',
                imageUrl: 'images/products/kolbasy/chorizo-70.jpg',
                composition: 'Ð¾Ð»ÐµÐ½Ð¸Ð½Ð°, Ð¶Ð¸Ñ€ Ð³Ð¾Ð²ÑÐ¶Ð¸Ð¹, ÑÐ¾Ð»ÑŒ Ð¿Ð¾Ð²Ð°Ñ€ÐµÐ½Ð½Ð°Ñ Ð¿Ð¸Ñ‰ÐµÐ²Ð°Ñ, ÑÐ¼ÐµÑÑŒ 5 Ð¿ÐµÑ€Ñ†ÐµÐ², Ð¿Ð°Ð¿Ñ€Ð¸ÐºÐ° ÐºÐ¾Ð¿Ñ‡ÐµÐ½Ð°Ñ, ÐºÐ°Ñ€Ð´Ð°Ð¼Ð¾Ð½, Ð¿ÐµÑ€ÐµÑ† Ñ‡ÐµÑ€Ð½Ñ‹Ð¹',
                nutrition: 'Ð±ÐµÐ»Ð¾Ðº - 15 Ð³, Ð¶Ð¸Ñ€ - 20 Ð³',
                calories: '510 ÐºÐºÐ°Ð»/2140 ÐºÐ”Ð¶',
                storage: '180 ÑÑƒÑ‚Ð¾Ðº',
                available: true
            },
            {
                id: 'trufel-70',
                name: 'ÐšÐ¾Ð»Ð±Ð°ÑÐ° ÑÑ‹Ñ€Ð¾Ð²ÑÐ»ÐµÐ½Ð°Ñ Ð¸Ð· Ð¾Ð»ÐµÐ½Ð¸Ð½Ñ‹ "Ð¡ Ð¢Ñ€ÑŽÑ„ÐµÐ»ÐµÐ¼"',
                price: 411,
                unit: '/70 Ð³Ñ€.',
                maxQty: 20,
                image: 'ðŸŒ­',
                imageUrl: 'images/products/kolbasy/trufel-70.jpg',
                composition: 'Ð¾Ð»ÐµÐ½Ð¸Ð½Ð°, Ð¶Ð¸Ñ€ Ð³Ð¾Ð²ÑÐ¶Ð¸Ð¹, ÑÐ¾Ð»ÑŒ Ð¿Ð¾Ð²Ð°Ñ€ÐµÐ½Ð½Ð°Ñ Ð¿Ð¸Ñ‰ÐµÐ²Ð°Ñ, ÑÐ¿ÐµÑ†Ð¸Ð¸, Ð¿ÐµÑ€ÐµÑ†, Ñ‚Ñ€ÑŽÑ„ÐµÐ»ÑŒ Ñ‡ÐµÑ€Ð½Ñ‹Ð¹ 0,02%, Ð¼ÑƒÑÐºÐ°Ñ‚Ð½Ñ‹Ð¹ Ð¾Ñ€ÐµÑ…',
                nutrition: 'Ð±ÐµÐ»Ð¾Ðº - 15 Ð³, Ð¶Ð¸Ñ€ - 20 Ð³',
                calories: '510 ÐºÐºÐ°Ð»/2140 ÐºÐ”Ð¶',
                storage: '180 ÑÑƒÑ‚Ð¾Ðº',
                available: true
            },
            {
                id: 'kedr-70',
                name: 'ÐšÐ¾Ð»Ð±Ð°ÑÐ° ÑÑ‹Ñ€Ð¾Ð²ÑÐ»ÐµÐ½Ð°Ñ Ð¸Ð· Ð¾Ð»ÐµÐ½Ð¸Ð½Ñ‹ "Ð¡ÐµÐ²ÐµÑ€Ð½Ð°Ñ Ñ ÐºÐµÐ´Ñ€Ð¾Ð²Ñ‹Ð¼ Ð¾Ñ€ÐµÑ…Ð¾Ð¼"',
                price: 405,
                unit: '/70 Ð³Ñ€.',
                maxQty: 20,
                image: 'ðŸŒ­',
                imageUrl: 'images/products/kolbasy/kedr-70.jpg',
                composition: 'Ð¾Ð»ÐµÐ½Ð¸Ð½Ð°, Ð¶Ð¸Ñ€ Ð³Ð¾Ð²ÑÐ¶Ð¸Ð¹, Ð¾Ñ€ÐµÑ… ÐºÐµÐ´Ñ€Ð¾Ð²Ñ‹Ð¹, ÑÐ¼ÐµÑÑŒ ÑÐ¿ÐµÑ†Ð¸Ð¹ Ð¸ Ð¿Ñ€ÑÐ½Ð¾ÑÑ‚ÐµÐ¹, ÑÐ¾Ð»ÑŒ Ð¿Ð¾Ð²Ð°Ñ€ÐµÐ½Ð½Ð°Ñ Ð¿Ð¸Ñ‰ÐµÐ²Ð°Ñ',
                nutrition: 'Ð±ÐµÐ»Ð¾Ðº - 15 Ð³, Ð¶Ð¸Ñ€ - 20 Ð³, ÑƒÐ³Ð»ÐµÐ²Ð¾Ð´Ñ‹ - 8 Ð³',
                calories: '540 ÐºÐºÐ°Ð»/2266 ÐºÐ”Ð¶',
                storage: '180 ÑÑƒÑ‚Ð¾Ðº',
                available: true
            },
            {
                id: 'osobaya-70',
                name: 'ÐšÐ¾Ð»Ð±Ð°ÑÐ° ÑÑ‹Ñ€Ð¾Ð²ÑÐ»ÐµÐ½Ð°Ñ Ð¸Ð· Ð¾Ð»ÐµÐ½Ð¸Ð½Ñ‹ "ÐžÑÐ¾Ð±Ð°Ñ"',
                price: 390,
                unit: '/70 Ð³Ñ€.',
                maxQty: 20,
                image: 'ðŸŒ­',
                imageUrl: 'images/products/kolbasy/osobaya-70.jpg',
                composition: 'Ð¾Ð»ÐµÐ½Ð¸Ð½Ð°, Ð¶Ð¸Ñ€ Ð³Ð¾Ð²ÑÐ¶Ð¸Ð¹, ÑÐ¾Ð»ÑŒ Ð¿Ð¾Ð²Ð°Ñ€ÐµÐ½Ð½Ð°Ñ Ð¿Ð¸Ñ‰ÐµÐ²Ð°Ñ, ÑÐ°Ñ…Ð°Ñ€, ÑÐ¿ÐµÑ†Ð¸Ð¸, Ñ‡ÐµÑÐ½Ð¾Ðº Ð¼Ð¾Ð»Ð¾Ñ‚Ñ‹Ð¹, Ð¼ÑƒÑÐºÐ°Ñ‚Ð½Ñ‹Ð¹ Ð¾Ñ€ÐµÑ…, Ð¿ÐµÑ€ÐµÑ†, Ð°Ð½Ñ‚Ð¸Ð¾ÐºÐ¸ÑÐ»Ð¸Ñ‚ÐµÐ»ÑŒ (Ð°ÑÐºÐ¾Ñ€Ð±Ð¸Ð½Ð¾Ð²Ð°Ñ ÐºÐ¸ÑÐ»Ð¾Ñ‚Ð°), ÑÑ‚Ð°Ñ€Ñ‚Ð¾Ð²Ñ‹Ðµ ÐºÑƒÐ»ÑŒÑ‚ÑƒÑ€Ñ‹ (Ð¼Ð¾Ð»Ð¾Ñ‡Ð½Ð¾ÐºÐ¸ÑÐ»Ñ‹Ðµ Ð¼Ð¸ÐºÑ€Ð¾Ð¾Ñ€Ð³Ð°Ð½Ð¸Ð·Ð¼Ñ‹)',
                nutrition: 'Ð±ÐµÐ»Ð¾Ðº - 15 Ð³, Ð¶Ð¸Ñ€ - 20 Ð³',
                calories: '510 ÐºÐºÐ°Ð»/2140 ÐºÐ”Ð¶',
                storage: '180 ÑÑƒÑ‚Ð¾Ðº',
                available: true
            },
            {
                id: 'chorizo-170',
                name: 'ÐšÐ¾Ð»Ð±Ð°ÑÐ° ÑÑ‹Ñ€Ð¾Ð²ÑÐ»ÐµÐ½Ð°Ñ Ð¸Ð· Ð¾Ð»ÐµÐ½Ð¸Ð½Ñ‹ "Ð§Ð¾Ñ€Ð¸Ð·Ð¾"',
                price: 860,
                unit: '/170 Ð³Ñ€.',
                maxQty: 15,
                image: 'ðŸŒ­',
                imageUrl: 'images/products/kolbasy/chorizo-170.jpg',
                composition: 'Ð¾Ð»ÐµÐ½Ð¸Ð½Ð°, Ð¶Ð¸Ñ€ Ð³Ð¾Ð²ÑÐ¶Ð¸Ð¹, ÑÐ¾Ð»ÑŒ Ð¿Ð¾Ð²Ð°Ñ€ÐµÐ½Ð½Ð°Ñ Ð¿Ð¸Ñ‰ÐµÐ²Ð°Ñ, ÑÐ¼ÐµÑÑŒ 5 Ð¿ÐµÑ€Ñ†ÐµÐ², Ð¿Ð°Ð¿Ñ€Ð¸ÐºÐ° ÐºÐ¾Ð¿Ñ‡ÐµÐ½Ð°Ñ, ÐºÐ°Ñ€Ð´Ð°Ð¼Ð¾Ð½, Ð¿ÐµÑ€ÐµÑ† Ñ‡ÐµÑ€Ð½Ñ‹Ð¹',
                nutrition: 'Ð±ÐµÐ»Ð¾Ðº - 15 Ð³, Ð¶Ð¸Ñ€ - 20 Ð³',
                calories: '510 ÐºÐºÐ°Ð»/2140 ÐºÐ”Ð¶',
                storage: '180 ÑÑƒÑ‚Ð¾Ðº',
                available: true
            },
            {
                id: 'trufel-200',
                name: 'ÐšÐ¾Ð»Ð±Ð°ÑÐ° ÑÑ‹Ñ€Ð¾Ð²ÑÐ»ÐµÐ½Ð°Ñ Ð¸Ð· Ð¾Ð»ÐµÐ½Ð¸Ð½Ñ‹ "Ð¡ Ð¢Ñ€ÑŽÑ„ÐµÐ»ÐµÐ¼"',
                price: 980,
                unit: '/200 Ð³Ñ€.',
                maxQty: 12,
                image: 'ðŸŒ­',
                imageUrl: 'images/products/kolbasy/trufel-200.jpg',
                composition: 'Ð¾Ð»ÐµÐ½Ð¸Ð½Ð°, Ð¶Ð¸Ñ€ Ð³Ð¾Ð²ÑÐ¶Ð¸Ð¹, ÑÐ¾Ð»ÑŒ Ð¿Ð¾Ð²Ð°Ñ€ÐµÐ½Ð½Ð°Ñ Ð¿Ð¸Ñ‰ÐµÐ²Ð°Ñ, ÑÐ¿ÐµÑ†Ð¸Ð¸, Ð¿ÐµÑ€ÐµÑ†, Ñ‚Ñ€ÑŽÑ„ÐµÐ»ÑŒ Ñ‡ÐµÑ€Ð½Ñ‹Ð¹ 0,02%, Ð¼ÑƒÑÐºÐ°Ñ‚Ð½Ñ‹Ð¹ Ð¾Ñ€ÐµÑ…',
                nutrition: 'Ð±ÐµÐ»Ð¾Ðº - 15 Ð³, Ð¶Ð¸Ñ€ - 20 Ð³',
                calories: '510 ÐºÐºÐ°Ð»/2140 ÐºÐ”Ð¶',
                storage: '180 ÑÑƒÑ‚Ð¾Ðº',
                available: true
            },
            {
                id: 'osobaya-170',
                name: 'ÐšÐ¾Ð»Ð±Ð°ÑÐ° ÑÑ‹Ñ€Ð¾Ð²ÑÐ»ÐµÐ½Ð°Ñ Ð¸Ð· Ð¾Ð»ÐµÐ½Ð¸Ð½Ñ‹ "ÐžÑÐ¾Ð±Ð°Ñ"',
                price: 885,
                unit: '/170 Ð³Ñ€.',
                maxQty: 12,
                image: 'ðŸŒ­',
                imageUrl: 'images/products/kolbasy/osobaya-170.jpg',
                composition: 'Ð¾Ð»ÐµÐ½Ð¸Ð½Ð°, Ð¶Ð¸Ñ€ Ð³Ð¾Ð²ÑÐ¶Ð¸Ð¹, ÑÐ¾Ð»ÑŒ Ð¿Ð¾Ð²Ð°Ñ€ÐµÐ½Ð½Ð°Ñ Ð¿Ð¸Ñ‰ÐµÐ²Ð°Ñ, ÑÐ°Ñ…Ð°Ñ€, ÑÐ¿ÐµÑ†Ð¸Ð¸, Ñ‡ÐµÑÐ½Ð¾Ðº Ð¼Ð¾Ð»Ð¾Ñ‚Ñ‹Ð¹, Ð¼ÑƒÑÐºÐ°Ñ‚Ð½Ñ‹Ð¹ Ð¾Ñ€ÐµÑ…, Ð¿ÐµÑ€ÐµÑ†',
                nutrition: 'Ð±ÐµÐ»Ð¾Ðº - 15 Ð³, Ð¶Ð¸Ñ€ - 20 Ð³',
                calories: '510 ÐºÐºÐ°Ð»/2140 ÐºÐ”Ð¶',
                storage: '180 ÑÑƒÑ‚Ð¾Ðº',
                available: true
            },
            {
                id: 'kedr-160',
                name: 'ÐšÐ¾Ð»Ð±Ð°ÑÐ° ÑÑ‹Ñ€Ð¾Ð²ÑÐ»ÐµÐ½Ð°Ñ Ð¸Ð· Ð¾Ð»ÐµÐ½Ð¸Ð½Ñ‹ "Ð¡ÐµÐ²ÐµÑ€Ð½Ð°Ñ Ñ ÐºÐµÐ´Ñ€Ð¾Ð²Ñ‹Ð¼ Ð¾Ñ€ÐµÑ…Ð¾Ð¼"',
                price: 910,
                unit: '/160 Ð³Ñ€.',
                maxQty: 10,
                image: 'ðŸŒ­',
                imageUrl: 'images/products/kolbasy/kedr-160.jpg',
                composition: 'Ð¾Ð»ÐµÐ½Ð¸Ð½Ð°, Ð¶Ð¸Ñ€ Ð³Ð¾Ð²ÑÐ¶Ð¸Ð¹, Ð¾Ñ€ÐµÑ… ÐºÐµÐ´Ñ€Ð¾Ð²Ñ‹Ð¹, ÑÐ¼ÐµÑÑŒ ÑÐ¿ÐµÑ†Ð¸Ð¹ Ð¸ Ð¿Ñ€ÑÐ½Ð¾ÑÑ‚ÐµÐ¹, ÑÐ¾Ð»ÑŒ Ð¿Ð¾Ð²Ð°Ñ€ÐµÐ½Ð½Ð°Ñ Ð¿Ð¸Ñ‰ÐµÐ²Ð°Ñ',
                nutrition: 'Ð±ÐµÐ»Ð¾Ðº - 15 Ð³, Ð¶Ð¸Ñ€ - 20 Ð³, ÑƒÐ³Ð»ÐµÐ²Ð¾Ð´Ñ‹ - 8 Ð³',
                calories: '540 ÐºÐºÐ°Ð»/2266 ÐºÐ”Ð¶',
                storage: '180 ÑÑƒÑ‚Ð¾Ðº',
                available: true
            }
        ],
        'pashtet': [
            {
                id: 'riyet-olene-griby',
                name: 'Ð Ð¸Ð¹ÐµÑ‚ Ð¸Ð· Ð¾Ð»ÐµÐ½Ð¸Ð½Ñ‹ Ñ Ð±ÐµÐ»Ñ‹Ð¼Ð¸ Ð³Ñ€Ð¸Ð±Ð°Ð¼Ð¸ Ð¸ Ñ‚Ñ€ÑŽÑ„ÐµÐ»ÐµÐ¼',
                price: 378,
                unit: '/85 Ð³Ñ€.',
                maxQty: 15,
                image: 'ðŸ¥«',
                imageUrl: 'images/products/pashtet/riyet-olene-griby.jpg',
                composition: 'Ð¼ÑÑÐ¾ ÑÐµÐ²ÐµÑ€Ð½Ð¾Ð³Ð¾ Ð¾Ð»ÐµÐ½Ñ, Ð³Ñ€Ð¸Ð±Ñ‹ Ð±ÐµÐ»Ñ‹Ðµ, Ñ‚Ñ€ÑŽÑ„ÐµÐ»ÑŒ Ñ‡ÐµÑ€Ð½Ñ‹Ð¹ 0,02%, Ð¶Ð¸Ñ€ Ð¾Ð»ÐµÐ½Ð¸Ð¹, Ð»ÑƒÐº Ñ€ÐµÐ¿Ñ‡Ð°Ñ‚Ñ‹Ð¹',
                nutrition: 'Ð±ÐµÐ»ÐºÐ¸ - 17,8 Ð³, Ð¶Ð¸Ñ€Ñ‹ - 19,8 Ð³, ÑƒÐ³Ð»ÐµÐ²Ð¾Ð´Ñ‹ - 2,6 Ð³',
                calories: '259,8 ÐºÐºÐ°Ð»/1087 ÐºÐ”Ð¶',
                storage: '90 ÑÑƒÑ‚Ð¾Ðº',
                available: true
            },
            {
                id: 'riyet-serdtse',
                name: 'Ð Ð¸Ð¹ÐµÑ‚ Ð¸Ð· ÑÐµÑ€Ð´Ñ†Ð° Ð¾Ð»ÐµÐ½Ñ Ñ ÑˆÐ°Ð¼Ð¿Ð¸Ð½ÑŒÐ¾Ð½Ð°Ð¼Ð¸, ÑÐ³Ð¾Ð´Ð°Ð¼Ð¸, Ð¼Ð¾Ð¶Ð¶ÐµÐ²ÐµÐ»ÑŒÐ½Ð¸ÐºÐ° Ð¸ Ñ€Ð¾Ð·Ð¼Ð°Ñ€Ð¸Ð½Ð¾Ð¼',
                price: 360,
                unit: '/85 Ð³Ñ€.',
                maxQty: 15,
                image: 'ðŸ¥«',
                imageUrl: 'images/products/pashtet/riyet-serdtse.jpg',
                composition: 'Ð¼ÑÑÐ¾ ÑÐµÐ²ÐµÑ€Ð½Ð¾Ð³Ð¾ Ð¾Ð»ÐµÐ½Ñ, Ð¼Ð¾Ñ€ÐºÐ¾Ð²ÑŒ, Ð»ÑƒÐº, Ð²Ð¸Ð½Ð¾ Ð±ÐµÐ»Ð¾Ðµ ÑÑƒÑ…Ð¾Ðµ, ÑÐ¾Ð»ÑŒ Ð¼Ð¾Ñ€ÑÐºÐ°Ñ, Ð¼Ð°ÑÐ»Ð¾ Ñ€Ð°ÑÑ‚Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ, Ð¼Ð°ÑÐ»Ð¾ ÑÐ»Ð¸Ð²Ð¾Ñ‡Ð½Ð¾Ðµ, ÑÐ¾Ð»ÑŒ, ÑÐ³Ð¾Ð´Ñ‹ Ð¼Ð¾Ð¶Ð¶ÐµÐ²ÐµÐ»ÑŒÐ½Ð¸ÐºÐ°, Ð¿ÐµÑ€ÐµÑ†',
                nutrition: 'Ð±ÐµÐ»ÐºÐ¸ - 12 Ð³, Ð¶Ð¸Ñ€Ñ‹ - 10 Ð³, ÑƒÐ³Ð»ÐµÐ²Ð¾Ð´Ñ‹ - 9 Ð³',
                calories: '182 ÐºÐºÐ°Ð»/762 ÐºÐ”Ð¶',
                storage: '90 ÑÑƒÑ‚Ð¾Ðº',
                available: true
            },
            {
                id: 'riyet-utka',
                name: 'Ð Ð¸Ð¹ÐµÑ‚ Ð¸Ð· Ð¿Ð¾Ð»ÑÑ€Ð½Ð¾Ð¹ ÑƒÑ‚ÐºÐ¸ Ñ Ñ‚Ñ€ÑŽÑ„ÐµÐ»ÐµÐ¼',
                price: 378,
                unit: '/85 Ð³Ñ€.',
                maxQty: 15,
                image: 'ðŸ¥«',
                imageUrl: 'images/products/pashtet/riyet-utka.jpg',
                composition: 'Ð¼ÑÑÐ¾ ÑƒÑ‚ÐºÐ¸, Ð±ÐµÐ»Ñ‹Ðµ Ð³Ñ€Ð¸Ð±Ñ‹, Ð²Ð¸Ð½Ð¾ Ð±ÐµÐ»Ð¾Ðµ ÑÑƒÑ…Ð¾Ðµ, ÑƒÑ‚Ð¸Ð½Ñ‹Ð¹ Ð¶Ð¸Ñ€, Ñ‚Ñ€ÑŽÑ„ÐµÐ»ÑŒ Ñ‡ÐµÑ€Ð½Ñ‹Ð¹ 0,02%, Ð»ÑƒÐº, ÑÐ¾Ð»ÑŒ Ð¼Ð¾Ñ€ÑÐºÐ°Ñ, ÑÐ¿ÐµÑ†Ð¸Ð¸',
                nutrition: 'Ð±ÐµÐ»ÐºÐ¸ - 13,3 Ð³, Ð¶Ð¸Ñ€Ñ‹ - 45,9 Ð³, ÑƒÐ³Ð»ÐµÐ²Ð¾Ð´Ñ‹ - 2,3 Ð³',
                calories: '496 ÐºÐºÐ°Ð»/2077 ÐºÐ”Ð¶',
                storage: '90 ÑÑƒÑ‚Ð¾Ðº',
                available: true
            },
            {
                id: 'riyet-yagnenok',
                name: 'Ð Ð¸Ð¹ÐµÑ‚ Ð¸Ð· ÑÐ³Ð½ÐµÐ½ÐºÐ°',
                price: 365,
                unit: '/85 Ð³Ñ€.',
                maxQty: 15,
                image: 'ðŸ¥«',
                imageUrl: 'images/products/pashtet/riyet-yagnenok.jpg',
                composition: 'Ð¼ÑÑÐ¾ ÑÐ³Ð½ÐµÐ½ÐºÐ°, Ð¼Ð°ÑÐ»Ð¾ Ñ€Ð°ÑÑ‚Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ, Ð»ÑƒÐº, ÑÐ¾Ð»ÑŒ Ð¼Ð¾Ñ€ÑÐºÐ°Ñ, ÑÐ¿ÐµÑ†Ð¸Ð¸',
                nutrition: 'Ð±ÐµÐ»ÐºÐ¸ - 15,7 Ð³, Ð¶Ð¸Ñ€Ñ‹ - 15,4 Ð³, ÑƒÐ³Ð»ÐµÐ²Ð¾Ð´Ñ‹ - 5,5 Ð³',
                calories: '223,4 ÐºÐºÐ°Ð»/935 ÐºÐ”Ð¶',
                storage: '90 ÑÑƒÑ‚Ð¾Ðº',
                available: true
            }
        ],
        'delikatesy': [
            {
                id: 'hamon-utka',
                name: 'Ð¥Ð°Ð¼Ð¾Ð½ Ð¸Ð· ÑƒÑ‚ÐºÐ¸ ÑÑ‹Ñ€Ð¾Ð²ÑÐ»ÐµÐ½Ñ‹Ð¹',
                price: 560,
                unit: '/70 Ð³Ñ€.',
                maxQty: 12,
                image: 'ðŸ¥©',
                imageUrl: 'images/products/delikatesy/hamon-utka.jpg',
                composition: 'Ñ„Ð¸Ð»Ðµ ÑƒÑ‚Ð¸Ð½Ð¾Ð¹ Ð³Ñ€ÑƒÐ´ÐºÐ¸ Ð¿Ñ€ÐµÐ¼Ð¸ÑƒÐ¼, ÑÐ¾Ð»ÑŒ, ÑÐ¿ÐµÑ†Ð¸Ð¸',
                nutrition: 'Ð±ÐµÐ»ÐºÐ¸ - 18,9 Ð³, Ð¶Ð¸Ñ€Ñ‹ - 9 Ð³, ÑƒÐ³Ð»ÐµÐ²Ð¾Ð´Ñ‹ - 1,9 Ð³',
                calories: '172 ÐºÐºÐ°Ð»/720,1 ÐºÐ”Ð¶',
                storage: '180 ÑÑƒÑ‚Ð¾Ðº',
                available: true
            },
            {
                id: 'karpachcho-olene',
                name: 'ÐšÐ°Ñ€Ð¿Ð°Ñ‡Ñ‡Ð¾ Ð¸Ð· Ð¾Ð»ÐµÐ½Ð¸Ð½Ñ‹ Ð²Ñ‹ÑÑˆÐ¸Ð¹ ÑÐ¾Ñ€Ñ‚',
                price: 495,
                unit: '/70 Ð³Ñ€.',
                maxQty: 12,
                image: 'ðŸ¥©',
                imageUrl: 'images/products/delikatesy/karpachcho-olene.jpg',
                composition: 'Ð¾Ð»ÐµÐ½Ð¸Ð½Ð° Ð²Ñ‹ÑÑˆÐ¸Ð¹ ÑÐ¾Ñ€Ñ‚, ÑÐ¿ÐµÑ†Ð¸Ð¸, ÑÐ¾Ð»ÑŒ',
                nutrition: 'Ð±ÐµÐ»ÐºÐ¸ - 22 Ð³, Ð¶Ð¸Ñ€Ñ‹ - 6 Ð³',
                calories: '160 ÐºÐºÐ°Ð»/620 ÐºÐ”Ð¶',
                storage: '180 ÑÑƒÑ‚Ð¾Ðº',
                available: true
            },
            {
                id: 'sneki-okorok',
                name: 'Ð¡Ð½ÐµÐºÐ¸ Ð¸Ð· Ð¾ÐºÐ¾Ñ€Ð¾ÐºÐ° Ð¾Ð»ÐµÐ½Ñ ÑÑ‹Ñ€Ð¾Ð²ÑÐ»ÐµÐ½Ñ‹Ðµ "Ð¢Ð°Ñ‘Ð¶Ð½Ñ‹Ðµ Ñ Ð´Ñ‹Ð¼ÐºÐ¾Ð¼"',
                price: 170,
                unit: '/30 Ð³Ñ€.',
                maxQty: 12,
                image: 'ðŸ¥©',
                imageUrl: 'images/products/delikatesy/sneki-okorok.jpg',
                composition: 'Ð¾Ð»ÐµÐ½Ð¸Ð½Ð° 1 ÑÐ¾Ñ€Ñ‚, ÑÐ¾Ð»ÑŒ Ð¿Ð¾Ð²Ð°Ñ€ÐµÐ½Ð½Ð°Ñ Ð¿Ð¸Ñ‰ÐµÐ²Ð°Ñ, BBQ Ð¿Ð°Ð¿Ñ€Ð¸ÐºÐ°, Ð¼ÑƒÑÐºÐ°Ñ‚Ð½Ñ‹Ð¹ Ð¾Ñ€ÐµÑ…',
                nutrition: 'Ð±ÐµÐ»ÐºÐ¸ - 20 Ð³, Ð¶Ð¸Ñ€Ñ‹ - 6 Ð³',
                calories: '180 ÐºÐºÐ°Ð»/610 ÐºÐ”Ð¶',
                storage: '180 ÑÑƒÑ‚Ð¾Ðº',
                available: true
            },
            {
                id: 'filey-olene',
                name: 'Ð¤Ð¸Ð»ÐµÐ¹ Ð¾Ð»ÐµÐ½Ñ ÑÑ‹Ñ€Ð¾Ð²ÑÐ»ÐµÐ½Ñ‹Ð¹',
                price: 490,
                unit: '/70 Ð³Ñ€.',
                maxQty: 12,
                image: 'ðŸ¥©',
                imageUrl: 'images/products/delikatesy/filey-olene.jpg',
                composition: 'Ð¾Ð»ÐµÐ½Ð¸Ð½Ð°, ÑÐ°Ñ…Ð°Ñ€, ÑÐºÑÑ‚Ñ€Ð°ÐºÑ‚Ñ‹ Ð¿Ñ€ÑÐ½Ð¾ÑÑ‚ÐµÐ¹ (Ñ‡ÐµÑ€Ð½Ñ‹Ð¹ Ð¿ÐµÑ€ÐµÑ†, ÐºÐ¾Ñ€Ð¸Ð°Ð½Ð´Ñ€), ÑÐ¾Ð»ÑŒ Ð¿Ð¾Ð²Ð°Ñ€ÐµÐ½Ð½Ð°Ñ Ð¿Ð¸Ñ‰ÐµÐ²Ð°Ñ',
                nutrition: 'Ð‘ÐµÐ»ÐºÐ¸ - 20,0 Ð³, Ð¶Ð¸Ñ€Ñ‹ - 10,0 Ð³, ÑƒÐ³Ð»ÐµÐ²Ð¾Ð´Ñ‹ - 1,5 Ð³',
                calories: '260 ÐºÐºÐ°Ð»/1090 ÐºÐ”Ð¶',
                storage: '180 ÑÑƒÑ‚Ð¾Ðº',
                available: true
            },
            {
                id: 'pastila-filey',
                name: 'ÐŸÐ°ÑÑ‚Ð¸Ð»Ð° ÑÑ‹Ñ€Ð¾Ð²ÑÐ»ÐµÐ½Ð°Ñ Ð¸Ð· Ñ„Ð¸Ð»ÐµÑ Ð¾Ð»ÐµÐ½Ñ',
                price: 250,
                unit: '/50 Ð³Ñ€.',
                maxQty: 15,
                image: 'ðŸ¥©',
                imageUrl: 'images/products/delikatesy/pastila-filey.jpg',
                composition: 'Ð²Ñ‹Ñ€ÐµÐ·ÐºÐ° Ð¾Ð»ÐµÐ½Ñ Ð²Ñ‹ÑÑˆÐ¸Ð¹ ÑÐ¾Ñ€Ñ‚, ÑÐ°Ñ…Ð°Ñ€, ÑÐ¾ÐµÐ²Ñ‹Ð¹ ÑÐ¾ÑƒÑ, ÑÐ¾Ð»ÑŒ Ð¿Ð¾Ð²Ð°Ñ€ÐµÐ½Ð½Ð°Ñ Ð¿Ð¸Ñ‰ÐµÐ²Ð°Ñ, Ð¿Ð°Ð¿Ñ€Ð¸ÐºÐ° BBQ, ÑÐ¼ÐµÑÑŒ ÑÐ¿ÐµÑ†Ð¸Ð¹, Ð¾ÑÑ‚Ñ€Ñ‹Ð¹ ÐºÐ°Ð¹ÐµÐ½ÑÐºÐ¸Ð¹ Ð¿ÐµÑ€ÐµÑ†, Ð½Ð¸Ñ‚Ñ€Ð¸Ñ‚Ð½Ð¾-Ð¿Ð¾ÑÐ¾Ð»Ð¾Ñ‡Ð½Ð°Ñ ÑÐ¼ÐµÑÑŒ',
                nutrition: 'Ð±ÐµÐ»ÐºÐ¸ - 25 Ð³, Ð¶Ð¸Ñ€Ñ‹ â€“ 10 Ð³, ÑƒÐ³Ð»ÐµÐ²Ð¾Ð´Ñ‹ - 3 Ð³',
                calories: '176 ÐºÐºÐ°Ð»/736 ÐºÐ”Ð¶',
                storage: '180 ÑÑƒÑ‚Ð¾Ðº',
                available: true
            },
            {
                id: 'chipsy-olene',
                name: 'Ð§Ð¸Ð¿ÑÑ‹ Ð¸Ð· Ð¾Ð»ÐµÐ½Ð¸Ð½Ñ‹ ÑÑ‹Ñ€Ð¾Ð²ÑÐ»ÐµÐ½Ñ‹Ðµ',
                price: 230,
                unit: '/50 Ð³Ñ€.',
                maxQty: 15,
                image: 'ðŸ¥©',
                imageUrl: 'images/products/delikatesy/chipsy-olene.jpg',
                composition: 'Ð¾Ð»ÐµÐ½Ð¸Ð½Ð° 1 ÑÐ¾Ñ€Ñ‚, ÑÐ¾Ð»ÑŒ, ÑÐ¾ÑƒÑ Ð²Ð¾Ñ€Ñ‡ÐµÑÑ‚ÐµÑ€, ÑÐ¿ÐµÑ†Ð¸Ð¸, ÑÐ°Ñ…Ð°Ñ€',
                nutrition: 'Ð±ÐµÐ»ÐºÐ¸ - 18,0 Ð³, Ð¶Ð¸Ñ€Ñ‹ - 7,0 Ð³, ÑƒÐ³Ð»ÐµÐ²Ð¾Ð´Ñ‹ - 12,0 Ð³',
                calories: '140 ÐºÐºÐ°Ð»/590 ÐºÐ”Ð¶',
                storage: '180 ÑÑƒÑ‚Ð¾Ðº',
                available: true
            }
        ],
        'gotovye': [
            {
                id: 'koreyka-yagody',
                name: 'ÐšÐ¾Ñ€ÐµÐ¹ÐºÐ° Ð¾Ð»ÐµÐ½Ñ Ð·Ð°Ð¿ÐµÑ‡Ñ‘Ð½Ð½Ð°Ñ Ð² ÑÐµÐ²ÐµÑ€Ð½Ñ‹Ñ… ÑÐ³Ð¾Ð´Ð°Ñ…',
                price: 4880,
                unit: '/ÐºÐ³',
                maxQty: 5,
                image: 'ðŸ”¥',
                imageUrl: 'images/products/gotovye/koreyka-yagody.jpg',
                composition: 'ÐºÐ¾Ñ€ÐµÐ¹ÐºÐ° Ð¾Ð»ÐµÐ½Ñ Ð²Ñ‹ÑÑˆÐ¸Ð¹ ÑÐ¾Ñ€Ñ‚, Ð¼Ð°Ñ€Ð¸Ð½Ð°Ð´ Ð¸Ð· Ð¡ÐµÐ²ÐµÑ€Ð½Ñ‹Ñ… ÑÐ³Ð¾Ð´ (Ð±Ñ€ÑƒÑÐ½Ð¸ÐºÐ°, Ð¼Ð¾Ñ€Ð¾ÑˆÐºÐ°), ÑÐ¿ÐµÑ†Ð¸Ð¸ (Ñ€Ð¾Ð·Ð¼Ð°Ñ€Ð¸Ð½, ÑÐ¼ÐµÑÑŒ Ð¿ÐµÑ€Ñ†ÐµÐ²), ÑÐ¾Ð»ÑŒ Ð¿Ð¾Ð²Ð°Ñ€ÐµÐ½Ð½Ð°Ñ Ð¿Ð¸Ñ‰ÐµÐ²Ð°Ñ',
                nutrition: 'Ð±ÐµÐ»ÐºÐ¸ - 22 Ð³, Ð¶Ð¸Ñ€Ñ‹ - 11 Ð³',
                calories: '260 ÐºÐºÐ°Ð»/1190 ÐºÐ”Ð¶',
                storage: '20 ÑÑƒÑ‚Ð¾Ðº',
                available: true
            },
            {
                id: 'koreyka-bbq',
                name: 'ÐšÐ¾Ñ€ÐµÐ¹ÐºÐ° Ð¾Ð»ÐµÐ½Ñ Ð·Ð°Ð¿ÐµÑ‡Ñ‘Ð½Ð½Ð°Ñ "BBQ"',
                price: 4880,
                unit: '/ÐºÐ³',
                maxQty: 5,
                image: 'ðŸ”¥',
                imageUrl: 'images/products/gotovye/koreyka-bbq.jpg',
                composition: 'ÐºÐ¾Ñ€ÐµÐ¹ÐºÐ° Ð¾Ð»ÐµÐ½Ñ Ð²Ñ‹ÑÑˆÐ¸Ð¹ ÑÐ¾Ñ€Ñ‚, ÐŸÐ°Ð¿Ñ€Ð¸ÐºÐ° BBQ, ÑÐ¾ÑƒÑ Ð²Ð¾Ñ€Ñ‡ÐµÑÑ‚ÐµÑ€, ÑÐ¿ÐµÑ†Ð¸Ð¸, ÑÐ¾Ð»ÑŒ Ð¿Ð¾Ð²Ð°Ñ€ÐµÐ½Ð½Ð°Ñ Ð¿Ð¸Ñ‰ÐµÐ²Ð°Ñ, Ð½Ð¸Ñ‚Ñ€Ð¸Ñ‚Ð½Ð¾-Ð¿Ð¾ÑÐ¾Ð»Ð¾Ñ‡Ð½Ð°Ñ ÑÐ¼ÐµÑÑŒ',
                nutrition: 'Ð±ÐµÐ»ÐºÐ¸ - 22 Ð³, Ð¶Ð¸Ñ€Ñ‹ - 11 Ð³',
                calories: '260 ÐºÐºÐ°Ð»/1190 ÐºÐ”Ð¶',
                storage: '20 ÑÑƒÑ‚Ð¾Ðº',
                available: true
            },
            {
                id: 'okorok-vino',
                name: 'ÐžÐºÐ¾Ñ€Ð¾Ðº Ð¾Ð»ÐµÐ½Ñ Ñ‚Ð¾Ð¼Ð»ÐµÐ½Ñ‹Ð¹ Ñ Ð²Ð¸Ð½Ð¾Ð¼ Ð¸ Ð¿Ñ€ÑÐ½Ñ‹Ð¼Ð¸ Ñ‚Ñ€Ð°Ð²Ð°Ð¼Ð¸',
                price: 4480,
                unit: '/ÐºÐ³',
                maxQty: 5,
                image: 'ðŸ”¥',
                imageUrl: 'images/products/gotovye/okorok-vino.jpg',
                composition: 'Ð¾ÐºÐ¾Ñ€Ð¾Ðº ÑÐµÐ²ÐµÑ€Ð½Ð¾Ð³Ð¾ Ð¾Ð»ÐµÐ½Ñ Ð²Ñ‹ÑÑˆÐ¸Ð¹ ÑÐ¾Ñ€Ñ‚, ÑÐ°Ñ…Ð°Ñ€, ÑÐ¾ÐµÐ²Ñ‹Ð¹ ÑÐ¾ÑƒÑ, ÑÐ¾Ð»ÑŒ Ð¿Ð¾Ð²Ð°Ñ€ÐµÐ½Ð½Ð°Ñ Ð¿Ð¸Ñ‰ÐµÐ²Ð°Ñ, Ñ‚Ð¸Ð¼ÑŒÑÐ½, Ñ€Ð¾Ð·Ð¼Ð°Ñ€Ð¸Ð½',
                nutrition: 'Ð±ÐµÐ»ÐºÐ¸ - 22 Ð³, Ð¶Ð¸Ñ€Ñ‹ - 6 Ð³',
                calories: '160 ÐºÐºÐ°Ð»/620 ÐºÐ”Ð¶',
                storage: '20 ÑÑƒÑ‚Ð¾Ðº',
                available: true
            },
            {
                id: 'okorok-trufel',
                name: 'ÐžÐºÐ¾Ñ€Ð¾Ðº Ð¾Ð»ÐµÐ½Ñ Ñ‚Ð¾Ð¼Ð»ÐµÐ½Ñ‹Ð¹ Ñ Ñ‚Ñ€ÑŽÑ„ÐµÐ»ÐµÐ¼',
                price: 4600,
                unit: '/ÐºÐ³',
                maxQty: 5,
                image: 'ðŸ”¥',
                imageUrl: 'images/products/gotovye/okorok-trufel.jpg',
                composition: 'Ð¾ÐºÐ¾Ñ€Ð¾Ðº ÑÐµÐ²ÐµÑ€Ð½Ð¾Ð³Ð¾ Ð¾Ð»ÐµÐ½Ñ Ð²Ñ‹ÑÑˆÐ¸Ð¹ ÑÐ¾Ñ€Ñ‚, Ð¼Ð°Ñ€Ð¸Ð½Ð°Ð´ (ÑÐ¾ÑƒÑ Ð²Ð¾Ñ€Ñ‡ÐµÑÑ‚ÐµÑ€, Guinness), Ñ‚Ñ€ÑŽÑ„ÐµÐ»ÑŒ Ñ‡ÐµÑ€Ð½Ñ‹Ð¹ 0,02%, ÑÐ¼ÐµÑÑŒ ÑÐ¿ÐµÑ†Ð¸Ð¹ (Ñ€Ð¾Ð·Ð¼Ð°Ñ€Ð¸Ð½, Ð¼ÑƒÑÐºÐ°Ñ‚Ð½Ñ‹Ð¹ Ð¾Ñ€ÐµÑ…, Ð°Ð½Ð¸Ñ), ÑÐ¾Ð»ÑŒ Ð¿Ð¾Ð²Ð°Ñ€ÐµÐ½Ð½Ð°Ñ Ð¿Ð¸Ñ‰ÐµÐ²Ð°Ñ',
                nutrition: 'Ð±ÐµÐ»ÐºÐ¸ - 22 Ð³, Ð¶Ð¸Ñ€Ñ‹ - 6 Ð³',
                calories: '160 ÐºÐºÐ°Ð»/620 ÐºÐ”Ð¶',
                storage: '20 ÑÑƒÑ‚Ð¾Ðº',
                available: true
            },
            {
                id: 'pastrami-trufel',
                name: 'ÐŸÐ°ÑÑ‚Ñ€Ð°Ð¼Ð¸ Ð¸Ð· Ð¾ÐºÐ¾Ñ€Ð¾ÐºÐ° Ð¾Ð»ÐµÐ½Ñ Ñ Ñ‚Ñ€ÑŽÑ„ÐµÐ»ÐµÐ¼',
                price: 4630,
                unit: '/ÐºÐ³',
                maxQty: 5,
                image: 'ðŸ”¥',
                imageUrl: 'images/products/gotovye/pastrami-trufel.jpg',
                composition: 'Ð¾ÐºÐ¾Ñ€Ð¾Ðº ÑÐµÐ²ÐµÑ€Ð½Ð¾Ð³Ð¾ Ð¾Ð»ÐµÐ½Ñ Ð²Ñ‹ÑÑˆÐ¸Ð¹ ÑÐ¾Ñ€Ñ‚, ÑÐ¼ÐµÑÑŒ ÑÐ¿ÐµÑ†Ð¸Ð¹ (Ñ‚Ð¸Ð¼ÑŒÑÐ½, Ñ€Ð¾Ð·Ð¼Ð°Ñ€Ð¸Ð½, ÐºÐ¾Ñ€Ð¸Ð°Ð½Ð´Ñ€), Ð¼Ð°Ñ€Ð¸Ð½Ð°Ð´ (Ð²Ð¸Ð½Ð¾ ÐºÑ€Ð°ÑÐ½Ð¾Ðµ ÑÑƒÑ…Ð¾Ðµ, Ð¼Ñ‘Ð´), ÑÐ¾Ð»ÑŒ Ð¿Ð¾Ð²Ð°Ñ€ÐµÐ½Ð½Ð°Ñ Ð¿Ð¸Ñ‰ÐµÐ²Ð°Ñ',
                nutrition: 'Ð±ÐµÐ»ÐºÐ¸ - 22 Ð³, Ð¶Ð¸Ñ€Ñ‹ - 6 Ð³',
                calories: '160 ÐºÐºÐ°Ð»/620 ÐºÐ”Ð¶',
                storage: '20 ÑÑƒÑ‚Ð¾Ðº',
                available: true
            }
        ],
        'zamorozhennye': [
            {
                id: 'pelmeni-severnye',
                name: 'ÐŸÐµÐ»ÑŒÐ¼ÐµÐ½Ð¸ Â«Ð¡ÐµÐ²ÐµÑ€Ð½Ñ‹ÐµÂ» Ñ Ñ‚Ñ€ÑŽÑ„ÐµÐ»ÐµÐ¼',
                price: 758,
                unit: '/500 Ð³Ñ€.',
                maxQty: 8,
                image: 'â„ï¸',
                imageUrl: 'images/products/zamorozhennye/pelmeni-severnye.jpg',
                composition: 'Ñ„Ð°Ñ€Ñˆ - Ð¾Ð»ÐµÐ½Ð¸Ð½Ð°, ÑÐ¾Ð»ÑŒ, Ð¿ÐµÑ€ÐµÑ†, Ñ‚Ñ€ÑŽÑ„ÐµÐ»ÑŒÐ½Ð¾Ðµ Ð¼Ð°ÑÐ»Ð¾, Ð¢ÐµÑÑ‚Ð¾ - Ð¼ÑƒÐºÐ° Ð¿ÑˆÐµÐ½Ð¸Ñ‡Ð½Ð°Ñ Ð²/Ñ, Ð²Ð¾Ð´Ð°, ÑÐ¾Ð»ÑŒ, ÑÐ¸Ñ‡Ð½Ñ‹Ð¹ Ð¼ÐµÐ»Ð°Ð½Ð¶, Ð¼Ð°ÑÐ»Ð¾ Ñ€Ð°ÑÑ‚Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ',
                nutrition: 'Ð±ÐµÐ»ÐºÐ¸ - 16 Ð³, Ð¶Ð¸Ñ€Ñ‹ - 12 Ð³, ÑƒÐ³Ð»ÐµÐ²Ð¾Ð´Ñ‹ - 28 Ð³',
                calories: '220 ÐºÐºÐ°Ð»/921 ÐºÐ”Ð¶',
                storage: '10 Ð¼ÐµÑÑÑ†ÐµÐ²',
                available: true
            },
            {
                id: 'pelmeni-taymyrskie',
                name: 'ÐŸÐµÐ»ÑŒÐ¼ÐµÐ½Ð¸ Â«Ð¢Ð°Ð¹Ð¼Ñ‹Ñ€ÑÐºÐ¸ÐµÂ»',
                price: 758,
                unit: '/500 Ð³Ñ€.',
                maxQty: 8,
                image: 'â„ï¸',
                imageUrl: 'images/products/zamorozhennye/pelmeni-taymyrskie.jpg',
                composition: 'Ð¾Ð»ÐµÐ½Ð¸Ð½Ð°, Ð»ÑƒÐº, Ð²Ð¾Ð´Ð°, ÑÐ¾Ð»ÑŒ Ð¿Ð¾Ð²Ð°Ñ€ÐµÐ½Ð½Ð°Ñ, Ð¿ÐµÑ€ÐµÑ† Ñ‡Ñ‘Ñ€Ð½Ñ‹Ð¹ Ð¼Ð¾Ð»Ð¾Ñ‚Ñ‹Ð¹. Ð¢ÐµÑÑ‚Ð¾ â€“ Ð¼ÑƒÐºÐ° Ð¿ÑˆÐµÐ½Ð¸Ñ‡Ð½Ð°Ñ Ð²/Ñ, Ð²Ð¾Ð´Ð°, ÑÐ¾Ð»ÑŒ, ÑÐ¸Ñ‡Ð½Ñ‹Ð¹ Ð¼ÐµÐ»Ð°Ð½Ð¶, Ð¼Ð°ÑÐ»Ð¾ Ñ€Ð°ÑÑ‚Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ',
                nutrition: 'Ð±ÐµÐ»ÐºÐ¸ - 22 Ð³, Ð¶Ð¸Ñ€Ñ‹ - 6 Ð³, ÑƒÐ³Ð»ÐµÐ²Ð¾Ð´Ñ‹ - 28 Ð³',
                calories: '220 ÐºÐºÐ°Ð»/921 ÐºÐ”Ð¶',
                storage: '10 Ð¼ÐµÑÑÑ†ÐµÐ²',
                available: true
            },
            {
                id: 'pelmeni-los-griby',
                name: 'ÐŸÐµÐ»ÑŒÐ¼ÐµÐ½Ð¸ Ñ Ð¼ÑÑÐ¾Ð¼ Ð»Ð¾ÑÑ Ð¸ Ð³Ñ€Ð¸Ð±Ð°Ð¼Ð¸',
                price: 780,
                unit: '/500 Ð³Ñ€.',
                maxQty: 8,
                image: 'â„ï¸',
                imageUrl: 'images/products/zamorozhennye/pelmeni-los-griby.jpg',
                composition: 'Ð¼ÑÑÐ¾ Ð»Ð¾ÑÑ, Ð³Ð¾Ð²ÑÐ¶Ð¸Ð¹ Ð¶Ð¸Ñ€, Ð»ÑƒÐº, Ð²Ð¾Ð´Ð°, Ð¿ÐµÑ€ÐµÑ† Ñ‡ÐµÑ€Ð½Ñ‹Ð¹ Ð¼Ð¾Ð»Ð¾Ñ‚Ñ‹Ð¹, ÑÐ¾Ð»ÑŒ Ð¿Ð¾Ð²Ð°Ñ€ÐµÐ½Ð½Ð°Ñ, Ð³Ñ€Ð¸Ð±Ñ‹ ÑˆÐ°Ð¼Ð¿Ð¸Ð½ÑŒÐ¾Ð½Ñ‹. Ð¢ÐµÑÑ‚Ð¾: Ð¼ÑƒÐºÐ° Ð²/Ñ, Ð²Ð¾Ð´Ð°, ÑÐ¸Ñ‡Ð½Ñ‹Ð¹ Ð¼ÐµÐ»Ð°Ð½Ð¶, ÑÐ¾Ð»ÑŒ Ð¿Ð¾Ð²Ð°Ñ€ÐµÐ½Ð½Ð°Ñ, Ð¼Ð°ÑÐ»Ð¾ Ñ€Ð°ÑÑ‚Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ',
                nutrition: 'Ð±ÐµÐ»ÐºÐ¸ - 16 Ð³, Ð¶Ð¸Ñ€Ñ‹ - 12 Ð³, ÑƒÐ³Ð»ÐµÐ²Ð¾Ð´Ñ‹ - 28 Ð³',
                calories: '220 ÐºÐºÐ°Ð»/921 ÐºÐ”Ð¶',
                storage: '10 Ð¼ÐµÑÑÑ†ÐµÐ²',
                available: true
            },
            {
                id: 'pelmeni-chernye',
                name: 'ÐŸÐµÐ»ÑŒÐ¼ÐµÐ½Ð¸ Ñ‡Ñ‘Ñ€Ð½Ñ‹Ðµ Ð¸Ð· Ð¾Ð»ÐµÐ½Ð¸Ð½Ñ‹ Ñ Ñ‚Ñ€ÑŽÑ„ÐµÐ»ÐµÐ¼ (Ñ€ÑƒÑ‡Ð½Ð°Ñ Ð»ÐµÐ¿ÐºÐ°)',
                price: 960,
                unit: '/500 Ð³Ñ€.',
                maxQty: 6,
                image: 'â„ï¸',
                imageUrl: 'images/products/zamorozhennye/pelmeni-chernye.jpg',
                composition: 'Ñ„Ð°Ñ€Ñˆ - Ð¾Ð»ÐµÐ½Ð¸Ð½Ð°, Ð¼Ð°ÑÐ»Ð¾ ÑÐ»Ð¸Ð²Ð¾Ñ‡Ð½Ð¾Ðµ, ÐµÐ¶ÐµÐ²Ð¸ÐºÐ°, ÑÐ¾Ð»ÑŒ, Ð¼ÑƒÑÐºÐ°Ñ‚Ð½Ñ‹Ð¹ Ð¾Ñ€ÐµÑ…, Ð¾Ñ€ÐµÐ³Ð°Ð½Ð¾, Ñ‚Ñ€ÑŽÑ„ÐµÐ»ÑŒ -0,02%, Ð¢ÐµÑÑ‚Ð¾ â€“ Ð¼ÑƒÐºÐ° Ð¿ÑˆÐµÐ½Ð¸Ñ‡Ð½Ð°Ñ Ð²/Ñ, Ð²Ð¾Ð´Ð°, ÑÐ¾Ð»ÑŒ, ÑÐ¸Ñ‡Ð½Ñ‹Ð¹ Ð¼ÐµÐ»Ð°Ð½Ð¶, Ñ‡ÐµÑ€Ð½Ð¸Ð»Ð° ÐºÐ°Ñ€Ð°ÐºÐ°Ñ‚Ð¸Ñ†Ñ‹',
                nutrition: 'Ð±ÐµÐ»ÐºÐ¸ - 22 Ð³, Ð¶Ð¸Ñ€Ñ‹ - 6 Ð³, ÑƒÐ³Ð»ÐµÐ²Ð¾Ð´Ñ‹ - 28 Ð³',
                calories: '220 ÐºÐºÐ°Ð»/921 ÐºÐ”Ð¶',
                storage: '10 Ð¼ÐµÑÑÑ†ÐµÐ²',
                available: true
            }
        ],
        'polufabrikaty': [
            {
                id: 'okorok-olene',
                name: 'ÐžÐºÐ¾Ñ€Ð¾Ðº Ð¾Ð»ÐµÐ½Ñ',
                price: 1970,
                unit: '/ÐºÐ³',
                maxQty: 6,
                image: 'ðŸ¥“',
                imageUrl: 'images/products/polufabrikaty/okorok-olene.jpg',
                composition: 'Ð¾Ð»ÐµÐ½Ð¸Ð½Ð° Ð¾ÐºÐ¾Ñ€Ð¾Ðº Ð²Ñ‹ÑÑˆÐ¸Ð¹ ÑÐ¾Ñ€Ñ‚',
                nutrition: 'Ð±ÐµÐ»ÐºÐ¸ - 22 Ð³, Ð¶Ð¸Ñ€Ñ‹ - 11 Ð³',
                calories: '260 ÐºÐºÐ°Ð»/1190 ÐºÐ”Ð¶',
                storage: '10 Ð¼ÐµÑÑÑ†ÐµÐ²',
                available: true
            },
            {
                id: 'vyrezka-olene',
                name: 'Ð’Ñ‹Ñ€ÐµÐ·ÐºÐ° Ð¾Ð»ÐµÐ½Ñ',
                price: 3160,
                unit: '/ÐºÐ³',
                maxQty: 4,
                image: 'ðŸ¥“',
                imageUrl: 'images/products/polufabrikaty/vyrezka-olene.jpg',
                composition: 'Ð²Ñ‹Ñ€ÐµÐ·ÐºÐ° Ð¾Ð»ÐµÐ½Ñ Ð²Ñ‹ÑÑˆÐ¸Ð¹ ÑÐ¾Ñ€Ñ‚',
                nutrition: 'Ð‘ÐµÐ»ÐºÐ¸ - 22 Ð³, Ð–Ð¸Ñ€Ñ‹ - 11 Ð³',
                calories: '260 ÐºÐºÐ°Ð»/1190 ÐºÐ”Ð¶',
                storage: '10 Ð¼ÐµÑÑÑ†ÐµÐ²',
                available: true
            },
            {
                id: 'koreyka-kost',
                name: 'ÐšÐ¾Ñ€ÐµÐ¹ÐºÐ° Ð¾Ð»ÐµÐ½Ñ Ð½Ð° ÐºÐ¾ÑÑ‚Ð¸',
                price: 3310,
                unit: '/ÐºÐ³',
                maxQty: 4,
                image: 'ðŸ¥“',
                imageUrl: 'images/products/polufabrikaty/koreyka-kost.jpg',
                composition: 'ÐºÐ¾Ñ€ÐµÐ¹ÐºÐ° Ð¾Ð»ÐµÐ½Ñ Ð²Ñ‹ÑÑˆÐ¸Ð¹ ÑÐ¾Ñ€Ñ‚',
                nutrition: 'Ð‘ÐµÐ»ÐºÐ¸ - 22 Ð³, Ð–Ð¸Ñ€Ñ‹ - 11 Ð³',
                calories: '260 ÐºÐºÐ°Ð»/1190 ÐºÐ”Ð¶',
                storage: '10 Ð¼ÐµÑÑÑ†ÐµÐ²',
                available: true
            },
            {
                id: 'kupaty-piknik',
                name: 'ÐšÑƒÐ¿Ð°Ñ‚Ñ‹ "ÐŸÐ¸ÐºÐ½Ð¸Ðº"',
                price: 1268,
                unit: '/ÐºÐ³',
                maxQty: 8,
                image: 'ðŸ¥“',
                imageUrl: 'images/products/polufabrikaty/kupaty-piknik.jpg',
                composition: 'Ð¾Ð»ÐµÐ½Ð¸Ð½Ð°, ÑˆÐ¿Ð¸Ðº, Ñ‡ÐµÑÐ½Ð¾Ðº, ÑÐ°Ñ…Ð°Ñ€, ÑÐºÑÑ‚Ñ€Ð°ÐºÑ‚Ñ‹ Ð¿Ñ€ÑÐ½Ð¾ÑÑ‚ÐµÐ¹, ÐºÐ¾Ñ€Ð¸Ð°Ð½Ð´Ñ€, Ñ‡ÐµÑ€Ð½Ñ‹Ð¹ Ð¿ÐµÑ€ÐµÑ†, ÑÐ¾Ð»ÑŒ Ð¿Ð¾Ð²Ð°Ñ€ÐµÐ½Ð½Ð°Ñ Ð¿Ð¸Ñ‰ÐµÐ²Ð°Ñ',
                nutrition: 'Ð±ÐµÐ»ÐºÐ¸ - 15,0 Ð³, Ð¶Ð¸Ñ€Ñ‹ - 21,0 Ð³, ÑƒÐ³Ð»ÐµÐ²Ð¾Ð´Ñ‹ - 1,5 Ð³',
                calories: '260 ÐºÐºÐ°Ð»/1090 ÐºÐ”Ð¶',
                storage: '12 Ð¼ÐµÑÑÑ†ÐµÐ²',
                available: true
            },
            {
                id: 'kupaty-tundra',
                name: 'ÐšÑƒÐ¿Ð°Ñ‚Ñ‹ "Ð¢ÑƒÐ½Ð´Ñ€Ð°"',
                price: 1268,
                unit: '/ÐºÐ³',
                maxQty: 8,
                image: 'ðŸ¥“',
                imageUrl: 'images/products/polufabrikaty/kupaty-tundra.jpg',
                composition: 'Ð¾Ð»ÐµÐ½Ð¸Ð½Ð°, ÑˆÐ¿Ð¸Ðº, Ð»ÑƒÐº, ÑÐ°Ñ…Ð°Ñ€, ÑÐºÑÑ‚Ñ€Ð°ÐºÑ‚Ñ‹ Ð¿Ñ€ÑÐ½Ð¾ÑÑ‚ÐµÐ¹, ÑÐ¾Ð»ÑŒ Ð¿Ð¾Ð²Ð°Ñ€ÐµÐ½Ð½Ð°Ñ Ð¿Ð¸Ñ‰ÐµÐ²Ð°Ñ',
                nutrition: 'Ð±ÐµÐ»ÐºÐ¸ - 15 Ð³, Ð¶Ð¸Ñ€Ñ‹ - 21 Ð³, ÑƒÐ³Ð»ÐµÐ²Ð¾Ð´Ñ‹ - 1 Ð³',
                calories: '250 ÐºÐºÐ°Ð»/1050 ÐºÐ”Ð¶',
                storage: '12 Ð¼ÐµÑÑÑ†ÐµÐ²',
                available: true
            },
            {
                id: 'kotleti-burger',
                name: 'ÐšÐ¾Ñ‚Ð»ÐµÑ‚Ñ‹ Ð´Ð»Ñ Ð±ÑƒÑ€Ð³ÐµÑ€Ð° Ð¸Ð· Ð¼ÑÑÐ° ÑÐµÐ²ÐµÑ€Ð½Ð¾Ð³Ð¾ Ð¾Ð»ÐµÐ½Ñ',
                price: 290,
                unit: '/300 Ð³Ñ€. (2 ÑˆÑ‚ÑƒÐºÐ¸)',
                maxQty: 10,
                image: 'ðŸ¥“',
                imageUrl: 'images/products/polufabrikaty/kotleti-burger.jpg',
                composition: 'Ð¼ÑÑÐ¾ ÑÐµÐ²ÐµÑ€Ð½Ð¾Ð³Ð¾ Ð¾Ð»ÐµÐ½Ñ Ñ€ÑƒÐ±Ð»ÐµÐ½Ð½Ð¾Ðµ, Ð¶Ð¸Ñ€ Ð¾Ð»ÐµÐ½Ð¸Ð¹',
                nutrition: 'Ð‘ÐµÐ»ÐºÐ¸ - 17 Ð³, Ð–Ð¸Ñ€Ñ‹ - 12 Ð³',
                calories: '270 ÐºÐºÐ°Ð»/980 ÐºÐ”Ð¶',
                storage: '10 Ð¼ÐµÑÑÑ†ÐµÐ²',
                available: true
            },
            {
                id: 'lopatka-olene',
                name: 'Ð›Ð¾Ð¿Ð°Ñ‚ÐºÐ° Ð¾Ð»ÐµÐ½Ñ Ð±ÐµÐ· ÐºÐ¾ÑÑ‚Ð¸',
                price: 1770,
                unit: '/ÐºÐ³',
                maxQty: 6,
                image: 'ðŸ¥“',
                imageUrl: 'images/products/polufabrikaty/lopatka-olene.jpg',
                composition: 'Ð¾Ð»ÐµÐ½Ð¸Ð½Ð° Ð»Ð¾Ð¿Ð°Ñ‚Ð¾Ñ‡Ð½Ð°Ñ Ñ‡Ð°ÑÑ‚ÑŒ Ð±ÐµÐ· ÐºÐ¾ÑÑ‚Ð¸',
                nutrition: 'Ð‘ÐµÐ»ÐºÐ¸ - 19 Ð³, Ð–Ð¸Ñ€Ñ‹ - 4 Ð³',
                calories: '112 ÐºÐºÐ°Ð»/780 ÐºÐ”Ð¶',
                storage: '10 Ð¼ÐµÑÑÑ†ÐµÐ²',
                available: true
            }
        ],
        'pirogi-sytnye': [
            {
                id: 'pirog-ohotnichiy',
                name: 'ÐŸÐ¸Ñ€Ð¾Ð³ Ñ Ð¾Ð»ÐµÐ½Ð¸Ð½Ð¾Ð¹ Ð¾Ñ…Ð¾Ñ‚Ð½Ð¸Ñ‡Ð¸Ð¹',
                price: 880,
                unit: '/550 Ð³Ñ€.',
                maxQty: 8,
                image: 'ðŸ¥§',
                imageUrl: 'images/products/pirogi-sytnye/pirog-ohotnichiy.jpg',
                composition: 'Ð¼ÑƒÐºÐ° Ð²/Ñ, Ð¾Ð»ÐµÐ½Ð¸Ð½Ð° Ð²/Ñ, Ñ‚Ð¾Ð¼Ð°Ñ‚Ñ‹ Ð²ÑÐ»ÐµÐ½Ñ‹Ðµ, Ð¼Ð°ÑÐ»Ð¾ Ð¾Ð»Ð¸Ð²ÐºÐ¾Ð²Ð¾Ðµ, ÑÐ¾Ð»ÑŒ, ÑÐ°Ñ…Ð°Ñ€, ÑÐ¹Ñ†Ð¾, Ð²Ð¾Ð´Ð°, Ð´Ñ€Ð¾Ð¶Ð¶Ð¸ Ñ…Ð»ÐµÐ±Ð¾Ð¿ÐµÐºÐ°Ñ€Ð½Ñ‹Ðµ, Ð»ÑƒÐº Ñ€ÐµÐ¿Ñ‡Ð°Ñ‚Ñ‹Ð¹, Ð¼Ð¾Ñ€ÐºÐ¾Ð²ÑŒ, ÑÐ¿ÐµÑ†Ð¸Ð¸',
                nutrition: 'Ð‘ÐµÐ»ÐºÐ¸ 11.55 Ð³, Ð–Ð¸Ñ€Ñ‹ 9.32 Ð³, Ð£Ð³Ð»ÐµÐ²Ð¾Ð´Ñ‹ 25.24 Ð³',
                calories: '232.8 ÐºÐºÐ°Ð»/974.1 ÐºÐ”Ð¶',
                storage: '6 Ð¼ÐµÑÑÑ†ÐµÐ²',
                available: true
            },
            {
                id: 'pirog-brusnika',
                name: 'ÐŸÐ¸Ñ€Ð¾Ð³ Ñ Ð¾Ð»ÐµÐ½Ð¸Ð½Ð¾Ð¹ Ð¸ Ð±Ñ€ÑƒÑÐ½Ð¸ÐºÐ¾Ð¹',
                price: 880,
                unit: '/550 Ð³Ñ€.',
                maxQty: 8,
                image: 'ðŸ¥§',
                imageUrl: 'images/products/pirogi-sytnye/pirog-brusnika.jpg',
                composition: 'Ð¼ÑƒÐºÐ° Ð²/Ñ, Ð¾Ð»ÐµÐ½Ð¸Ð½Ð° Ð²/Ñ, Ð±Ñ€ÑƒÑÐ½Ð¸ÐºÐ°, ÑÐ¾ÐµÐ²Ñ‹Ð¹ ÑÐ¾ÑƒÑ, ÑÐ¾Ð»ÑŒ, ÑÐ°Ñ…Ð°Ñ€, ÑÐ¹Ñ†Ð¾, Ð²Ð¾Ð´Ð°, Ð´Ñ€Ð¾Ð¶Ð¶Ð¸ Ñ…Ð»ÐµÐ±Ð¾Ð¿ÐµÐºÐ°Ñ€Ð½Ñ‹Ðµ, Ð¼Ð°ÑÐ»Ð¾ Ñ€Ð°ÑÑ‚Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ, Ð»ÑƒÐº Ñ€ÐµÐ¿Ñ‡Ð°Ñ‚Ñ‹Ð¹, ÑÐ¿ÐµÑ†Ð¸Ð¸',
                nutrition: 'Ð‘ÐµÐ»ÐºÐ¸ 14.02 Ð³, Ð–Ð¸Ñ€Ñ‹ 9.12 Ð³, Ð£Ð³Ð»ÐµÐ²Ð¾Ð´Ñ‹ 23.42 Ð³',
                calories: '233.2 ÐºÐºÐ°Ð»/917.6 ÐºÐ”Ð¶',
                storage: '6 Ð¼ÐµÑÑÑ†ÐµÐ²',
                available: true
            },
            {
                id: 'pirog-griby-trufel',
                name: 'ÐŸÐ¸Ñ€Ð¾Ð³ Ñ Ð¾Ð»ÐµÐ½Ð¸Ð½Ð¾Ð¹, Ð³Ñ€Ð¸Ð±Ð°Ð¼Ð¸ Ð¸ Ñ‚Ñ€ÑŽÑ„ÐµÐ»ÐµÐ¼',
                price: 880,
                unit: '/550 Ð³Ñ€.',
                maxQty: 8,
                image: 'ðŸ¥§',
                imageUrl: 'images/products/pirogi-sytnye/pirog-griby-trufel.jpg',
                composition: 'Ð¼ÑƒÐºÐ° Ð²/Ñ, Ð¾Ð»ÐµÐ½Ð¸Ð½Ð° Ð²/Ñ, ÑˆÐ°Ð¼Ð¿Ð¸Ð½ÑŒÐ¾Ð½Ñ‹ ÑÐ²ÐµÐ¶Ð¸Ðµ, Ñ‚Ñ€ÑŽÑ„ÐµÐ»ÑŒÐ½Ð°Ñ Ð¿Ð°ÑÑ‚Ð°, Ð¼Ð°ÑÐ»Ð¾ Ð¾Ð»Ð¸Ð²ÐºÐ¾Ð²Ð¾Ðµ, ÑÐ¾Ð»ÑŒ, ÑÐ°Ñ…Ð°Ñ€, ÑÐ¹Ñ†Ð¾, Ð²Ð¾Ð´Ð°, Ð´Ñ€Ð¾Ð¶Ð¶Ð¸ Ñ…Ð»ÐµÐ±Ð¾Ð¿ÐµÐºÐ°Ñ€Ð½Ñ‹Ðµ, Ð»ÑƒÐº Ñ€ÐµÐ¿Ñ‡Ð°Ñ‚Ñ‹Ð¹, ÑÐ¿ÐµÑ†Ð¸Ð¸',
                nutrition: 'Ð‘ÐµÐ»ÐºÐ¸ 13.02 Ð³, Ð–Ð¸Ñ€Ñ‹ 9.31 Ð³, Ð£Ð³Ð»ÐµÐ²Ð¾Ð´Ñ‹ 25.42 Ð³',
                calories: '235.2 ÐºÐºÐ°Ð»/921.4 ÐºÐ”Ð¶',
                storage: '6 Ð¼ÐµÑÑÑ†ÐµÐ²',
                available: true
            },
            {
                id: 'pirog-gribnoy',
                name: 'ÐŸÐ¸Ñ€Ð¾Ð³ Ñ Ð³Ñ€Ð¸Ð±Ð½Ñ‹Ð¼ Ð¶ÑŽÐ»ÑŒÐµÐ½Ð¾Ð¼',
                price: 964,
                unit: '/700 Ð³Ñ€.',
                maxQty: 6,
                image: 'ðŸ¥§',
                imageUrl: 'images/products/pirogi-sytnye/pirog-gribnoy.jpg',
                composition: 'Ð¼ÑƒÐºÐ° Ð²/Ñ, ÑˆÐ°Ð¼Ð¿Ð¸Ð½ÑŒÐ¾Ð½Ñ‹ ÑÐ²ÐµÐ¶Ð¸Ðµ, ÑÐ»Ð¸Ð²ÐºÐ¸ Ð½Ð°Ñ‚ÑƒÑ€Ð°Ð»ÑŒÐ½Ñ‹Ðµ, ÑÐ¾Ð»ÑŒ, ÑÐ°Ñ…Ð°Ñ€, ÑÐ¹Ñ†Ð¾, Ð²Ð¾Ð´Ð°, Ð´Ñ€Ð¾Ð¶Ð¶Ð¸ Ñ…Ð»ÐµÐ±Ð¾Ð¿ÐµÐºÐ°Ñ€Ð½Ñ‹Ðµ, Ð¼Ð°ÑÐ»Ð¾ Ñ€Ð°ÑÑ‚Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ, Ð»ÑƒÐº Ñ€ÐµÐ¿Ñ‡Ð°Ñ‚Ñ‹Ð¹, ÑÐ¿ÐµÑ†Ð¸Ð¸',
                nutrition: 'Ð‘ÐµÐ»ÐºÐ¸ 8.8 Ð³, Ð–Ð¸Ñ€Ñ‹ 8.9 Ð³, Ð£Ð³Ð»ÐµÐ²Ð¾Ð´Ñ‹ 22.6 Ð³',
                calories: '241.2 ÐºÐºÐ°Ð»/1009.68 ÐºÐ”Ð¶',
                storage: '6 Ð¼ÐµÑÑÑ†ÐµÐ²',
                available: true
            },
            {
                id: 'pirog-kuritsa-griby',
                name: 'ÐŸÐ¸Ñ€Ð¾Ð³ Ñ ÐºÑƒÑ€Ð¸Ñ†ÐµÐ¹ Ð¸ Ð³Ñ€Ð¸Ð±Ð°Ð¼Ð¸',
                price: 980,
                unit: '/700 Ð³Ñ€.',
                maxQty: 6,
                image: 'ðŸ¥§',
                imageUrl: 'images/products/pirogi-sytnye/pirog-kuritsa-griby.jpg',
                composition: 'Ð¼ÑƒÐºÐ° Ð²/Ñ, ÐºÑƒÑ€Ð¸Ð½Ð¾Ðµ Ñ„Ð¸Ð»Ðµ, ÑˆÐ°Ð¼Ð¿Ð¸Ð½ÑŒÐ¾Ð½Ñ‹ ÑÐ²ÐµÐ¶Ð¸Ðµ, ÑÐ¾Ð»ÑŒ, ÑÐ°Ñ…Ð°Ñ€, ÑÐ¹Ñ†Ð¾, Ð²Ð¾Ð´Ð°, Ð´Ñ€Ð¾Ð¶Ð¶Ð¸ Ñ…Ð»ÐµÐ±Ð¾Ð¿ÐµÐºÐ°Ñ€Ð½Ñ‹Ðµ, Ð¼Ð°ÑÐ»Ð¾ Ñ€Ð°ÑÑ‚Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ, Ð»ÑƒÐº Ñ€ÐµÐ¿Ñ‡Ð°Ñ‚Ñ‹Ð¹, ÑÐ¿ÐµÑ†Ð¸Ð¸',
                nutrition: 'Ð‘ÐµÐ»ÐºÐ¸ 11.4 Ð³, Ð–Ð¸Ñ€Ñ‹ 2.8 Ð³, Ð£Ð³Ð»ÐµÐ²Ð¾Ð´Ñ‹ 24.5 Ð³',
                calories: '255.3 ÐºÐºÐ°Ð»/1085 ÐºÐ”Ð¶',
                storage: '6 Ð¼ÐµÑÑÑ†ÐµÐ²',
                available: true
            },
            {
                id: 'pirog-kartofel-griby',
                name: 'ÐŸÐ¸Ñ€Ð¾Ð³ Ñ ÐºÐ°Ñ€Ñ‚Ð¾Ñ„ÐµÐ»ÐµÐ¼ Ð¸ Ð³Ñ€Ð¸Ð±Ð°Ð¼Ð¸',
                price: 922,
                unit: '/700 Ð³Ñ€.',
                maxQty: 6,
                image: 'ðŸ¥§',
                imageUrl: 'images/products/pirogi-sytnye/pirog-kartofel-griby.jpg',
                composition: 'Ð¼ÑƒÐºÐ° Ð²/Ñ, ÐºÐ°Ñ€Ñ‚Ð¾Ñ„ÐµÐ»ÑŒ, ÑˆÐ°Ð¼Ð¿Ð¸Ð½ÑŒÐ¾Ð½Ñ‹ ÑÐ²ÐµÐ¶Ð¸Ðµ, ÑÐ¾Ð»ÑŒ, ÑÐ°Ñ…Ð°Ñ€, ÑÐ¹Ñ†Ð¾, Ð²Ð¾Ð´Ð°, Ð´Ñ€Ð¾Ð¶Ð¶Ð¸ Ñ…Ð»ÐµÐ±Ð¾Ð¿ÐµÐºÐ°Ñ€Ð½Ñ‹Ðµ, Ð¼Ð°ÑÐ»Ð¾ Ñ€Ð°ÑÑ‚Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ, Ð»ÑƒÐº Ñ€ÐµÐ¿Ñ‡Ð°Ñ‚Ñ‹Ð¹, ÑÐ¿ÐµÑ†Ð¸Ð¸',
                nutrition: 'Ð‘ÐµÐ»ÐºÐ¸ 4.6 Ð³, Ð–Ð¸Ñ€Ñ‹ 7.8 Ð³, Ð£Ð³Ð»ÐµÐ²Ð¾Ð´Ñ‹ 18.4 Ð³',
                calories: '154.8 ÐºÐºÐ°Ð»/904 ÐºÐ”Ð¶',
                storage: '6 Ð¼ÐµÑÑÑ†ÐµÐ²',
                available: true
            },
            {
                id: 'pirog-krasnaya-ryba',
                name: 'ÐŸÐ¸Ñ€Ð¾Ð³ Ñ ÐºÑ€Ð°ÑÐ½Ð¾Ð¹ Ñ€Ñ‹Ð±Ð¾Ð¹',
                price: 2460,
                unit: '/700 Ð³Ñ€.',
                maxQty: 4,
                image: 'ðŸ¥§',
                imageUrl: 'images/products/pirogi-sytnye/pirog-krasnaya-ryba.jpg',
                composition: 'Ð¼ÑƒÐºÐ° Ð²/Ñ, ÑÐµÐ¼Ð³Ð° (Ð»Ð¾ÑÐ¾ÑÑŒ), ÑÐ¾Ð»ÑŒ, ÑÐ°Ñ…Ð°Ñ€, ÑÐ¹Ñ†Ð¾, Ð²Ð¾Ð´Ð°, Ð´Ñ€Ð¾Ð¶Ð¶Ð¸ Ñ…Ð»ÐµÐ±Ð¾Ð¿ÐµÐºÐ°Ñ€Ð½Ñ‹Ðµ, Ð¼Ð°ÑÐ»Ð¾ Ñ€Ð°ÑÑ‚Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ, Ð»ÑƒÐº Ñ€ÐµÐ¿Ñ‡Ð°Ñ‚Ñ‹Ð¹, ÑÐ¿ÐµÑ†Ð¸Ð¸',
                nutrition: 'Ð‘ÐµÐ»ÐºÐ¸ 14.9 Ð³, Ð–Ð¸Ñ€Ñ‹ 13 Ð³, Ð£Ð³Ð»ÐµÐ²Ð¾Ð´Ñ‹ 24.6 Ð³',
                calories: '274.7 ÐºÐºÐ°Ð»/1150.4 ÐºÐ”Ð¶',
                storage: '6 Ð¼ÐµÑÑÑ†ÐµÐ²',
                available: true
            }
        ],
        'pirogi-sladkie': [
            {
                id: 'pirog-yabloko-smorodina',
                name: 'ÐŸÐ¸Ñ€Ð¾Ð³ Ñ ÑÐ±Ð»Ð¾ÐºÐ¾Ð¼ Ð¸ Ñ‡ÐµÑ€Ð½Ð¾Ð¹ ÑÐ¼Ð¾Ñ€Ð¾Ð´Ð¸Ð½Ð¾Ð¹',
                price: 860,
                unit: '/700 Ð³Ñ€.',
                maxQty: 6,
                image: 'ðŸ§',
                imageUrl: 'images/products/pirogi-sladkie/pirog-yabloko-smorodina.jpg',
                composition: 'Ð¼ÑƒÐºÐ° Ð²/Ñ, ÑÐ±Ð»Ð¾ÐºÐ¸ Ð½Ð°Ñ‚ÑƒÑ€Ð°Ð»ÑŒÐ½Ñ‹Ðµ, Ñ‡ÐµÑ€Ð½Ð°Ñ ÑÐ¼Ð¾Ñ€Ð¾Ð´Ð¸Ð½Ð° Ð½Ð°Ñ‚ÑƒÑ€Ð°Ð»ÑŒÐ½Ð°Ñ, ÑÐ¾Ð»ÑŒ, ÑÐ°Ñ…Ð°Ñ€, ÑÐ¹Ñ†Ð¾, Ð²Ð¾Ð´Ð°, Ð¼Ð°ÑÐ»Ð¾ Ñ€Ð°ÑÑ‚Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ, Ð´Ñ€Ð¾Ð¶Ð¶Ð¸ Ñ…Ð»ÐµÐ±Ð¾Ð¿ÐµÐºÐ°Ñ€Ð½Ñ‹Ðµ',
                nutrition: 'Ð‘ÐµÐ»ÐºÐ¸ 6.2 Ð³, Ð–Ð¸Ñ€Ñ‹ 5.4 Ð³, Ð£Ð³Ð»ÐµÐ²Ð¾Ð´Ñ‹ 52.8 Ð³',
                calories: '251.4 ÐºÐºÐ°Ð»/1163.3 ÐºÐ”Ð¶',
                storage: '6 Ð¼ÐµÑÑÑ†ÐµÐ²',
                available: true
            },
            {
                id: 'pirog-vishnya',
                name: 'ÐŸÐ¸Ñ€Ð¾Ð³ Ñ Ð²Ð¸ÑˆÐ½ÐµÐ¹',
                price: 885,
                unit: '/700 Ð³Ñ€.',
                maxQty: 6,
                image: 'ðŸ§',
                imageUrl: 'images/products/pirogi-sladkie/pirog-vishnya.jpg',
                composition: 'Ð¼ÑƒÐºÐ° Ð²/Ñ, Ð²Ð¸ÑˆÐ½Ñ Ð½Ð°Ñ‚ÑƒÑ€Ð°Ð»ÑŒÐ½Ð°Ñ, ÑÐ¾Ð»ÑŒ, ÑÐ°Ñ…Ð°Ñ€, ÑÐ¹Ñ†Ð¾, Ð²Ð¾Ð´Ð°, Ð¼Ð°ÑÐ»Ð¾ Ñ€Ð°ÑÑ‚Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ, Ð´Ñ€Ð¾Ð¶Ð¶Ð¸ Ñ…Ð»ÐµÐ±Ð¾Ð¿ÐµÐºÐ°Ñ€Ð½Ñ‹Ðµ',
                nutrition: 'Ð‘ÐµÐ»ÐºÐ¸ 6.5 Ð³, Ð–Ð¸Ñ€Ñ‹ 5.8 Ð³, Ð£Ð³Ð»ÐµÐ²Ð¾Ð´Ñ‹ 52.4 Ð³',
                calories: '285.4 ÐºÐºÐ°Ð»/1195.4 ÐºÐ”Ð¶',
                storage: '6 Ð¼ÐµÑÑÑ†ÐµÐ²',
                available: true
            },
            {
                id: 'pirog-tvorog-klubnika',
                name: 'ÐŸÐ¸Ñ€Ð¾Ð³ Ñ Ñ‚Ð²Ð¾Ñ€Ð¾Ð³Ð¾Ð¼ Ð¸ ÐºÐ»ÑƒÐ±Ð½Ð¸ÐºÐ¾Ð¹',
                price: 874,
                unit: '/700 Ð³Ñ€.',
                maxQty: 6,
                image: 'ðŸ§',
                imageUrl: 'images/products/pirogi-sladkie/pirog-tvorog-klubnika.jpg',
                composition: 'Ð¼ÑƒÐºÐ° Ð²/Ñ, ÐºÐ»ÑƒÐ±Ð½Ð¸ÐºÐ° Ð½Ð°Ñ‚ÑƒÑ€Ð°Ð»ÑŒÐ½Ð°Ñ, ÐºÑ€ÐµÐ¼ Ð²Ð°Ð½Ð¸Ð»ÑŒÐ½Ð¾-ÑÐ»Ð¸Ð²Ð¾Ñ‡Ð½Ñ‹Ð¹ Ð·Ð°Ð²Ð°Ñ€Ð½Ð¾Ð¹, ÑÐ¾Ð»ÑŒ, ÑÐ°Ñ…Ð°Ñ€, ÑÐ¹Ñ†Ð¾, Ð²Ð¾Ð´Ð°, Ð¼Ð°ÑÐ»Ð¾ Ñ€Ð°ÑÑ‚Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ, Ð´Ñ€Ð¾Ð¶Ð¶Ð¸ Ñ…Ð»ÐµÐ±Ð¾Ð¿ÐµÐºÐ°Ñ€Ð½Ñ‹Ðµ',
                nutrition: 'Ð‘ÐµÐ»ÐºÐ¸ 8.3 Ð³, Ð–Ð¸Ñ€Ñ‹ 7.1 Ð³, Ð£Ð³Ð»ÐµÐ²Ð¾Ð´Ñ‹ 38.4 Ð³',
                calories: '285.6 ÐºÐºÐ°Ð»/1049.2 ÐºÐ”Ð¶',
                storage: '6 Ð¼ÐµÑÑÑ†ÐµÐ²',
                available: true
            },
            {
                id: 'pirog-tvorog-chernika',
                name: 'ÐŸÐ¸Ñ€Ð¾Ð³ Ñ Ñ‚Ð²Ð¾Ñ€Ð¾Ð³Ð¾Ð¼ Ð¸ Ñ‡ÐµÑ€Ð½Ð¸ÐºÐ¾Ð¹',
                price: 878,
                unit: '/700 Ð³Ñ€.',
                maxQty: 6,
                image: 'ðŸ§',
                imageUrl: 'images/products/pirogi-sladkie/pirog-tvorog-chernika.jpg',
                composition: 'Ð¼ÑƒÐºÐ° Ð²/Ñ, Ñ‡ÐµÑ€Ð½Ð¸ÐºÐ° Ð½Ð°Ñ‚ÑƒÑ€Ð°Ð»ÑŒÐ½Ð°Ñ, ÐºÑ€ÐµÐ¼ Ð²Ð°Ð½Ð¸Ð»ÑŒÐ½Ð¾-ÑÐ»Ð¸Ð²Ð¾Ñ‡Ð½Ñ‹Ð¹ Ð·Ð°Ð²Ð°Ñ€Ð½Ð¾Ð¹ ÑÐ¾Ð»ÑŒ, ÑÐ°Ñ…Ð°Ñ€, ÑÐ¹Ñ†Ð¾, Ð²Ð¾Ð´Ð°, Ð¼Ð°ÑÐ»Ð¾ Ñ€Ð°ÑÑ‚Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ, Ð´Ñ€Ð¾Ð¶Ð¶Ð¸ Ñ…Ð»ÐµÐ±Ð¾Ð¿ÐµÐºÐ°Ñ€Ð½Ñ‹Ðµ',
                nutrition: 'Ð‘ÐµÐ»ÐºÐ¸ 8.2 Ð³, Ð–Ð¸Ñ€Ñ‹ 6.8 Ð³, Ð£Ð³Ð»ÐµÐ²Ð¾Ð´Ñ‹ 37.8 Ð³',
                calories: '258.6 ÐºÐºÐ°Ð»/1049.2 ÐºÐ”Ð¶',
                storage: '6 Ð¼ÐµÑÑÑ†ÐµÐ²',
                available: true
            },
            {
                id: 'pirog-tvorog-malina',
                name: 'ÐŸÐ¸Ñ€Ð¾Ð³ Ñ Ñ‚Ð²Ð¾Ñ€Ð¾Ð³Ð¾Ð¼ Ð¸ Ð¼Ð°Ð»Ð¸Ð½Ð¾Ð¹',
                price: 880,
                unit: '/700 Ð³Ñ€.',
                maxQty: 6,
                image: 'ðŸ§',
                imageUrl: 'images/products/pirogi-sladkie/pirog-tvorog-malina.jpg',
                composition: 'Ð¼ÑƒÐºÐ° Ð²/Ñ, Ð¼Ð°Ð»Ð¸Ð½Ð° Ð½Ð°Ñ‚ÑƒÑ€Ð°Ð»ÑŒÐ½Ð°Ñ, ÐºÑ€ÐµÐ¼ Ð²Ð°Ð½Ð¸Ð»ÑŒÐ½Ð¾-ÑÐ»Ð¸Ð²Ð¾Ñ‡Ð½Ñ‹Ð¹ Ð·Ð°Ð²Ð°Ñ€Ð½Ð¾Ð¹, ÑÐ¾Ð»ÑŒ, ÑÐ°Ñ…Ð°Ñ€, ÑÐ¹Ñ†Ð¾, Ð²Ð¾Ð´Ð°, Ð¼Ð°ÑÐ»Ð¾ Ñ€Ð°ÑÑ‚Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ, Ð´Ñ€Ð¾Ð¶Ð¶Ð¸ Ñ…Ð»ÐµÐ±Ð¾Ð¿ÐµÐºÐ°Ñ€Ð½Ñ‹Ðµ',
                nutrition: 'Ð‘ÐµÐ»ÐºÐ¸ 8.4 Ð³, Ð–Ð¸Ñ€Ñ‹ 7.2 Ð³, Ð£Ð³Ð»ÐµÐ²Ð¾Ð´Ñ‹ 38.1 Ð³',
                calories: '250.8 ÐºÐºÐ°Ð»/1050 ÐºÐ”Ð¶',
                storage: '6 Ð¼ÐµÑÑÑ†ÐµÐ²',
                available: true
            },
            {
                id: 'pirog-chernika',
                name: 'ÐŸÐ¸Ñ€Ð¾Ð³ Ñ Ñ‡ÐµÑ€Ð½Ð¸ÐºÐ¾Ð¹',
                price: 885,
                unit: '/700 Ð³Ñ€.',
                maxQty: 6,
                image: 'ðŸ§',
                imageUrl: 'images/products/pirogi-sladkie/pirog-chernika.jpg',
                composition: 'Ð¼ÑƒÐºÐ° Ð²/Ñ, Ñ‡ÐµÑ€Ð½Ð¸ÐºÐ° Ð½Ð°Ñ‚ÑƒÑ€Ð°Ð»ÑŒÐ½Ð°Ñ, ÑÐ¾Ð»ÑŒ, ÑÐ°Ñ…Ð°Ñ€, ÑÐ¹Ñ†Ð¾, Ð²Ð¾Ð´Ð°, Ð¼Ð°ÑÐ»Ð¾ Ñ€Ð°ÑÑ‚Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ, Ð´Ñ€Ð¾Ð¶Ð¶Ð¸ Ñ…Ð»ÐµÐ±Ð¾Ð¿ÐµÐºÐ°Ñ€Ð½Ñ‹Ðµ',
                nutrition: 'Ð‘ÐµÐ»ÐºÐ¸ 2.7 Ð³, Ð–Ð¸Ñ€Ñ‹ 9.9 Ð³, Ð£Ð³Ð»ÐµÐ²Ð¾Ð´Ñ‹ 33.4 Ð³',
                calories: '245.8 ÐºÐºÐ°Ð»/1026.18 ÐºÐ”Ð¶',
                storage: '6 Ð¼ÐµÑÑÑ†ÐµÐ²',
                available: true
            },
            {
                id: 'pirog-yabloko-brusnika',
                name: 'ÐŸÐ¸Ñ€Ð¾Ð³ Ñ ÑÐ±Ð»Ð¾ÐºÐ¾Ð¼ Ð¸ Ð±Ñ€ÑƒÑÐ½Ð¸ÐºÐ¾Ð¹',
                price: 868,
                unit: '/700 Ð³Ñ€.',
                maxQty: 6,
                image: 'ðŸ§',
                imageUrl: 'images/products/pirogi-sladkie/pirog-yabloko-brusnika.jpg',
                composition: 'Ð¼ÑƒÐºÐ° Ð²/Ñ, Ð±Ñ€ÑƒÑÐ½Ð¸ÐºÐ° Ð½Ð°Ñ‚ÑƒÑ€Ð°Ð»ÑŒÐ½Ð°Ñ, ÑÐ±Ð»Ð¾ÐºÐ¸ Ð½Ð°Ñ‚ÑƒÑ€Ð°Ð»ÑŒÐ½Ñ‹Ðµ, ÑÐ¾Ð»ÑŒ, ÑÐ°Ñ…Ð°Ñ€, ÑÐ¹Ñ†Ð¾, Ð²Ð¾Ð´Ð°, Ð¼Ð°ÑÐ»Ð¾ Ñ€Ð°ÑÑ‚Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ, Ð´Ñ€Ð¾Ð¶Ð¶Ð¸ Ñ…Ð»ÐµÐ±Ð¾Ð¿ÐµÐºÐ°Ñ€Ð½Ñ‹Ðµ',
                nutrition: 'Ð‘ÐµÐ»ÐºÐ¸ 3.5 Ð³, Ð–Ð¸Ñ€Ñ‹ 4 Ð³, Ð£Ð³Ð»ÐµÐ²Ð¾Ð´Ñ‹ 35.7 Ð³',
                calories: '192.3 ÐºÐºÐ°Ð»/805.25 ÐºÐ”Ð¶',
                storage: '6 Ð¼ÐµÑÑÑ†ÐµÐ²',
                available: true
            },
            {
                id: 'pirog-yabloko',
                name: 'ÐŸÐ¸Ñ€Ð¾Ð³ Ñ ÑÐ±Ð»Ð¾ÐºÐ¾Ð¼',
                price: 860,
                unit: '/700 Ð³Ñ€.',
                maxQty: 6,
                image: 'ðŸ§',
                imageUrl: 'images/products/pirogi-sladkie/pirog-yabloko.jpg',
                composition: 'Ð¼ÑƒÐºÐ° Ð²/Ñ, ÑÐ±Ð»Ð¾ÐºÐ¸ Ð½Ð°Ñ‚ÑƒÑ€Ð°Ð»ÑŒÐ½Ñ‹Ðµ, ÑÐ¾Ð»ÑŒ, ÑÐ°Ñ…Ð°Ñ€, ÑÐ¹Ñ†Ð¾, Ð²Ð¾Ð´Ð°, Ð¼Ð°ÑÐ»Ð¾ Ñ€Ð°ÑÑ‚Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ, Ð´Ñ€Ð¾Ð¶Ð¶Ð¸ Ñ…Ð»ÐµÐ±Ð¾Ð¿ÐµÐºÐ°Ñ€Ð½Ñ‹Ðµ',
                nutrition: 'Ð‘ÐµÐ»ÐºÐ¸ 9.2 Ð³, Ð–Ð¸Ñ€Ñ‹ 5.4 Ð³, Ð£Ð³Ð»ÐµÐ²Ð¾Ð´Ñ‹ 52.8 Ð³',
                calories: '258.4 ÐºÐºÐ°Ð»/1184.3 ÐºÐ”Ð¶',
                storage: '6 Ð¼ÐµÑÑÑ†ÐµÐ²',
                available: true
            }
        ]
        // âœ… Ð“ÐžÐ¢ÐžÐ’Ðž! Ð’Ð¡Ð• 8 ÐšÐÐ¢Ð•Ð“ÐžÐ Ð˜Ð™, 49 Ð¢ÐžÐ’ÐÐ ÐžÐ’!
    };
}

// ðŸ’³ Ð¤Ð£ÐÐšÐ¦Ð˜Ð¯ Ð¡ÐžÐ—Ð”ÐÐÐ˜Ð¯ ÐŸÐ›ÐÐ¢Ð•Ð–Ð Ð’ YOOKASSA
async function createYooKassaPayment(orderId, amount, description, customerInfo) {
    try {
        const payment = await checkout.createPayment({
            amount: {
                value: amount.toFixed(2),
                currency: 'RUB'
            },
            confirmation: {
                type: 'redirect',
                return_url: `${config.FRONTEND_URL}/payment/success?order=${orderId}`
            },
            capture: true,
            description: description,
            metadata: {
                orderId: orderId,
                customerName: customerInfo.customerName || 'ÐšÐ»Ð¸ÐµÐ½Ñ‚',
                phone: customerInfo.phone || ''
            }
        }, crypto.randomUUID());

        console.log(`ðŸ’³ ÐŸÐ»Ð°Ñ‚ÐµÐ¶ ÑÐ¾Ð·Ð´Ð°Ð½ Ð² Ð®Kassa: ${payment.id} Ð½Ð° ÑÑƒÐ¼Ð¼Ñƒ ${amount}â‚½`);
        return payment;
    } catch (error) {
        console.error('âŒ ÐžÑˆÐ¸Ð±ÐºÐ° ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ Ð¿Ð»Ð°Ñ‚ÐµÐ¶Ð° Ð®Kassa:', error);
        throw error;
    }
}

// Ð¤ÑƒÐ½ÐºÑ†Ð¸Ð¸ Ð´Ð»Ñ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ Ñ Ð·Ð°ÐºÐ°Ð·Ð°Ð¼Ð¸
function createOrder(orderData) {
    orderCounter++;
    const orderId = orderCounter.toString();
    
    const order = {
        id: orderId,
        status: 'new', // new, accepted, preparing, delivering, completed, cancelled, expired
        paymentStatus: 'pending', // pending, paid, cancelled, expired
        createdAt: new Date(),
        updatedAt: new Date(),
        expiresAt: new Date(Date.now() + 30 * 60 * 1000), // 30 Ð¼Ð¸Ð½ÑƒÑ‚
        ...orderData
    };
    
    // ðŸ’¾ Ð¡ÐžÐ¥Ð ÐÐÐ¯Ð•Ðœ Ð’ Ð‘Ð” Ð˜ Ð’ ÐŸÐÐœÐ¯Ð¢Ð¬
    orders.set(orderId, order);
    
    // Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÑÐµÐ¼ Ð² Ð±Ð°Ð·Ñƒ Ð´Ð°Ð½Ð½Ñ‹Ñ…
    try {
        OrdersDB.create(order);
        console.log(`ðŸ’¾ Ð—Ð°ÐºÐ°Ð· ${orderId} ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½ Ð² Ð‘Ð”`);
    } catch (error) {
        console.error(`âŒ ÐžÑˆÐ¸Ð±ÐºÐ° ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ Ð·Ð°ÐºÐ°Ð·Ð° ${orderId} Ð² Ð‘Ð”:`, error);
    }
    
    // ðŸ”¥ Ð—ÐÐŸÐ£Ð¡ÐšÐÐ•Ðœ Ð¢ÐÐ™ÐœÐ•Ð  ÐÐ’Ð¢ÐžÐžÐ¢ÐœÐ•ÐÐ« ÐÐ 30 ÐœÐ˜ÐÐ£Ð¢
    const timer = setTimeout(() => {
        autoExpireOrder(orderId);
    }, 30 * 60 * 1000); // 30 Ð¼Ð¸Ð½ÑƒÑ‚
    
    orderTimers.set(orderId, timer);
    
    console.log(`ðŸ”¥ Ð—Ð°ÐºÐ°Ð· ${orderId} ÑÐ¾Ð·Ð´Ð°Ð½. ÐÐ²Ñ‚Ð¾Ð¾Ñ‚Ð¼ÐµÐ½Ð° Ñ‡ÐµÑ€ÐµÐ· 30 Ð¼Ð¸Ð½ÑƒÑ‚.`);
    
    return order;
}

function updateOrderStatus(orderId, newStatus) {
    const order = orders.get(orderId);
    if (order) {
        order.status = newStatus;
        order.updatedAt = new Date();
        orders.set(orderId, order);
        return order;
    }
    return null;
}

function getOrder(orderId) {
    return orders.get(orderId);
}

function getAllOrders() {
    return Array.from(orders.values()).sort((a, b) => b.createdAt - a.createdAt);
}

// ðŸ”¥ Ð¤Ð£ÐÐšÐ¦Ð˜Ð¯ ÐÐ’Ð¢ÐžÐœÐÐ¢Ð˜Ð§Ð•Ð¡ÐšÐžÐ™ ÐžÐ¢ÐœÐ•ÐÐ« Ð—ÐÐšÐÐ—Ð
function autoExpireOrder(orderId) {
    const order = orders.get(orderId);
    if (!order) {
        console.log(`âš ï¸ Ð—Ð°ÐºÐ°Ð· ${orderId} Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½ Ð´Ð»Ñ Ð°Ð²Ñ‚Ð¾Ð¾Ñ‚Ð¼ÐµÐ½Ñ‹`);
        return;
    }
    
    // ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼, Ð½Ðµ Ð±Ñ‹Ð» Ð»Ð¸ Ð·Ð°ÐºÐ°Ð· ÑƒÐ¶Ðµ Ð¾Ð¿Ð»Ð°Ñ‡ÐµÐ½
    if (order.paymentStatus === 'paid') {
        console.log(`âœ… Ð—Ð°ÐºÐ°Ð· ${orderId} ÑƒÐ¶Ðµ Ð¾Ð¿Ð»Ð°Ñ‡ÐµÐ½, Ð¾Ñ‚Ð¼ÐµÐ½Ð° Ð¾Ñ‚Ð¼ÐµÐ½ÐµÐ½Ð°`);
        clearOrderTimer(orderId);
        return;
    }
    
    // ÐžÑ‚Ð¼ÐµÐ½ÑÐµÐ¼ Ð·Ð°ÐºÐ°Ð·
    order.status = 'expired';
    order.paymentStatus = 'expired';
    order.updatedAt = new Date();
    orders.set(orderId, order);
    
    // ÐžÑ‡Ð¸Ñ‰Ð°ÐµÐ¼ Ñ‚Ð°Ð¹Ð¼ÐµÑ€
    clearOrderTimer(orderId);
    
    console.log(`â° Ð—Ð°ÐºÐ°Ð· ${orderId} Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ Ð¾Ñ‚Ð¼ÐµÐ½ÐµÐ½ (Ð²Ñ€ÐµÐ¼Ñ Ð¸ÑÑ‚ÐµÐºÐ»Ð¾)`);
}

// Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð¾Ñ‡Ð¸ÑÑ‚ÐºÐ¸ Ñ‚Ð°Ð¹Ð¼ÐµÑ€Ð° Ð·Ð°ÐºÐ°Ð·Ð°
function clearOrderTimer(orderId) {
    const timer = orderTimers.get(orderId);
    if (timer) {
        clearTimeout(timer);
        orderTimers.delete(orderId);
    }
}

// Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð¾Ñ‚Ð¼ÐµÐ½Ñ‹ Ñ‚Ð°Ð¹Ð¼ÐµÑ€Ð° Ð¿Ñ€Ð¸ Ð¾Ð¿Ð»Ð°Ñ‚Ðµ
function cancelOrderTimer(orderId) {
    clearOrderTimer(orderId);
    console.log(`ðŸ”¥ Ð¢Ð°Ð¹Ð¼ÐµÑ€ Ð·Ð°ÐºÐ°Ð·Ð° ${orderId} Ð¾Ñ‚Ð¼ÐµÐ½ÐµÐ½ (Ð·Ð°ÐºÐ°Ð· Ð¾Ð¿Ð»Ð°Ñ‡ÐµÐ½)`);
}

// ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° ÑÑ‚Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ñ… Ñ„Ð°Ð¹Ð»Ð¾Ð²
const webRoot = path.join(__dirname, 'webapp');
app.use(express.static(webRoot));

// Health check endpoints
app.get('/health', (req, res) => {
    res.status(200).json({ 
        status: 'ok', 
        timestamp: new Date().toISOString(),
        uptime: process.uptime()
    });
});

app.get('/ping', (req, res) => {
    res.status(200).send('pong');
});

// API Ð´Ð»Ñ Ð·Ð°ÐºÐ°Ð·Ð¾Ð²
app.post('/api/orders', async (req, res) => {
    try {
        const orderData = req.body;
        
        // Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ Ð·Ð°ÐºÐ°Ð·
        const order = createOrder(orderData);
        
        console.log(`ðŸ“ Ð—Ð°ÐºÐ°Ð· #${order.id} ÑÐ¾Ð·Ð´Ð°Ð½, ÑÐ¾Ð·Ð´Ð°ÐµÐ¼ Ð¿Ð»Ð°Ñ‚ÐµÐ¶ Ð² Ð®Kassa...`);
        console.log(`ðŸ’° Ð¡ÑƒÐ¼Ð¼Ð° Ð·Ð°ÐºÐ°Ð·Ð°: ${order.totals?.total || 0}â‚½`);
        
        // ðŸ’³ Ð¡ÐžÐ—Ð”ÐÐ•Ðœ ÐŸÐ›ÐÐ¢Ð•Ð– Ð’ YOOKASSA
        const totalAmount = order.totals?.total || 0;
        const description = `Ð—Ð°ÐºÐ°Ð· #${order.id} Ð² Tundra Gourmet`;
        
        if (!config.YOOKASSA_SHOP_ID || !config.YOOKASSA_SECRET_KEY) {
            console.error('âŒ Ð®Kassa ÐºÐ»ÑŽÑ‡Ð¸ Ð½Ðµ Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐ½Ñ‹!');
            throw new Error('Ð®Kassa ÐºÐ»ÑŽÑ‡Ð¸ Ð½Ðµ Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐ½Ñ‹');
        }
        
        const customerInfo = {
            customerName: `${order.address?.street || ''} ${order.address?.house || ''}`.trim() || 'ÐšÐ»Ð¸ÐµÐ½Ñ‚',
            phone: order.phone || ''
        };
        
        // Ð”Ð¾Ð±Ð°Ð²Ð»ÑÐµÐ¼ customerName Ð² Ð·Ð°ÐºÐ°Ð·
        order.customerName = customerInfo.customerName;
        
        const payment = await createYooKassaPayment(order.id, totalAmount, description, customerInfo);
        
        // Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÑÐµÐ¼ ID Ð¿Ð»Ð°Ñ‚ÐµÐ¶Ð° Ð² Ð·Ð°ÐºÐ°Ð·Ðµ
        order.paymentId = payment.id;
        order.paymentUrl = payment.confirmation.confirmation_url;
        orders.set(order.id, order);
        
        // ÐžÐ±Ð½Ð¾Ð²Ð»ÑÐµÐ¼ Ð² Ð‘Ð”
        try {
            await OrdersDB.update(order.id, order);
        } catch (dbError) {
            console.error(`âŒ ÐžÑˆÐ¸Ð±ÐºÐ° Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ Ð·Ð°ÐºÐ°Ð·Ð° Ð² Ð‘Ð”:`, dbError);
        }
        
        console.log(`âœ… Ð—Ð°ÐºÐ°Ð· #${order.id} Ð¸ Ð¿Ð»Ð°Ñ‚ÐµÐ¶ ÑÐ¾Ð·Ð´Ð°Ð½Ñ‹ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾`);
        console.log(`ðŸ”— Payment URL: ${payment.confirmation.confirmation_url}`);
        
        // ðŸ”¥ ÐÐ• ÐžÐ¢ÐŸÐ ÐÐ’Ð›Ð¯Ð•Ðœ Ð£Ð’Ð•Ð”ÐžÐœÐ›Ð•ÐÐ˜Ð• Ð’ ÐÐ”ÐœÐ˜Ð Ð“Ð Ð£ÐŸÐŸÐ£
        // Ð£Ð²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ðµ Ð±ÑƒÐ´ÐµÑ‚ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¾ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð¿Ð¾ÑÐ»Ðµ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾Ð¹ Ð¾Ð¿Ð»Ð°Ñ‚Ñ‹!
        
        const response = { 
            ok: true, 
            orderId: order.id,
            paymentUrl: payment.confirmation.confirmation_url,
            paymentId: payment.id,
            amount: totalAmount
        };
        
        console.log(`ðŸ“¤ ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð»ÑÐµÐ¼ Ð¾Ñ‚Ð²ÐµÑ‚ ÐºÐ»Ð¸ÐµÐ½Ñ‚Ñƒ:`, response);
        res.json(response);
    } catch (error) {
        console.error('âŒ ÐžÑˆÐ¸Ð±ÐºÐ° Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸ Ð·Ð°ÐºÐ°Ð·Ð°:', error);
        console.error('âŒ Ð”ÐµÑ‚Ð°Ð»Ð¸ Ð¾ÑˆÐ¸Ð±ÐºÐ¸:', error.stack);
        
        // Ð•ÑÐ»Ð¸ Ð¾ÑˆÐ¸Ð±ÐºÐ° Ð®Kassa, Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð¸Ð¼ Ð·Ð°ÐºÐ°Ð· Ð±ÐµÐ· Ð¿Ð»Ð°Ñ‚ÐµÐ¶Ð° Ð´Ð»Ñ Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ
        if (error.message.includes('Ð®Kassa') || error.message.includes('shopId') || error.message.includes('secretKey')) {
            console.log('âš ï¸ Ð®Kassa Ð½ÐµÐ´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð°, Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð»ÑÐµÐ¼ Ð·Ð°ÐºÐ°Ð· Ð±ÐµÐ· Ð¿Ð»Ð°Ñ‚ÐµÐ¶Ð° (Ð´Ð»Ñ Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ)');
            res.json({ 
                ok: true, 
                orderId: orders.get(orders.size)?.id || '1',
                paymentUrl: null,
                error: 'Ð®Kassa Ð½Ðµ Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐ½Ð° - Ñ‚ÐµÑÑ‚Ð¾Ð²Ñ‹Ð¹ Ñ€ÐµÐ¶Ð¸Ð¼'
            });
        } else {
            res.status(500).json({ ok: false, error: error.message });
        }
    }
});

// API Ð´Ð»Ñ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ Ð¸ÑÑ‚Ð¾Ñ€Ð¸Ð¸ Ð¿Ð¾ÐºÑƒÐ¿Ð¾Ðº ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð°
app.get('/api/purchases/:userId', async (req, res) => {
    try {
        const { userId } = req.params;
        
        // Ð—Ð°Ð³Ñ€ÑƒÐ¶Ð°ÐµÐ¼ Ð¸ÑÑ‚Ð¾Ñ€Ð¸ÑŽ Ð¿Ð¾ÐºÑƒÐ¿Ð¾Ðº Ð¸Ð· Ð‘Ð”
        const purchases = await PurchaseHistoryDB.getByUserId(userId);
        
        // ÐŸÐ¾Ð´ÑÑ‡Ð¸Ñ‚Ñ‹Ð²Ð°ÐµÐ¼ ÑÑ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÑƒ Ð»Ð¾ÑÐ»ÑŒÐ½Ð¾ÑÑ‚Ð¸
        const totalPurchases = purchases.length;
        const totalSpent = purchases.reduce((sum, purchase) => sum + (purchase.totalAmount || 0), 0);
        
        // ðŸ† Ð›ÐžÐ“Ð˜ÐšÐ ÐšÐÐ Ð¢Ð« Ð›ÐžÐ¯Ð›Ð¬ÐÐžÐ¡Ð¢Ð˜ ÐŸÐž Ð£Ð ÐžÐ’ÐÐ¯Ðœ
        let loyaltyLevel, currentDiscount, nextLevelTarget, nextLevelProgress;
        
        if (totalSpent < 10000) {
            // ðŸ’œ 0â‚½ - 9,999â‚½ â†’ 0% ÑÐºÐ¸Ð´ÐºÐ°
            loyaltyLevel = 0;
            currentDiscount = 0;
            nextLevelTarget = 10000;
            nextLevelProgress = (totalSpent / 10000) * 100;
        } else if (totalSpent < 25000) {
            // â­ 10,000â‚½ - 24,999â‚½ â†’ 3% ÑÐºÐ¸Ð´ÐºÐ°
            loyaltyLevel = 1;
            currentDiscount = 3;
            nextLevelTarget = 25000;
            nextLevelProgress = ((totalSpent - 10000) / (25000 - 10000)) * 100;
        } else if (totalSpent < 50000) {
            // â­ 25,000â‚½ - 49,999â‚½ â†’ 5% ÑÐºÐ¸Ð´ÐºÐ°
            loyaltyLevel = 2;
            currentDiscount = 5;
            nextLevelTarget = 50000;
            nextLevelProgress = ((totalSpent - 25000) / (50000 - 25000)) * 100;
        } else {
            // â­ 50,000â‚½+ â†’ 10% ÑÐºÐ¸Ð´ÐºÐ°
            loyaltyLevel = 3;
            currentDiscount = 10;
            nextLevelTarget = null; // Ð¼Ð°ÐºÑÐ¸Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ð¹ ÑƒÑ€Ð¾Ð²ÐµÐ½ÑŒ
            nextLevelProgress = 100;
        }
        
        res.json({
            ok: true,
            purchases,
            stats: {
                totalPurchases,
                totalSpent,
                loyaltyLevel,
                currentDiscount,
                nextLevelProgress: Math.round(nextLevelProgress),
                nextLevelTarget,
                levelName: loyaltyLevel === 0 ? "ÐÐ¾Ð²Ð¸Ñ‡Ð¾Ðº" : 
                          loyaltyLevel === 1 ? "Ð‘Ñ€Ð¾Ð½Ð·Ð°" :
                          loyaltyLevel === 2 ? "Ð¡ÐµÑ€ÐµÐ±Ñ€Ð¾" : "Ð—Ð¾Ð»Ð¾Ñ‚Ð¾"
            }
        });
        
    } catch (error) {
        console.error('âŒ ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ Ð¸ÑÑ‚Ð¾Ñ€Ð¸Ð¸ Ð¿Ð¾ÐºÑƒÐ¿Ð¾Ðº:', error);
        res.status(500).json({ ok: false, error: error.message });
    }
});

// API Ð´Ð»Ñ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ Ð²ÑÐµÑ… Ð·Ð°ÐºÐ°Ð·Ð¾Ð²
app.get('/api/orders', (req, res) => {
    try {
        const allOrders = getAllOrders();
        res.json({ ok: true, orders: allOrders });
    } catch (error) {
        console.error('ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ Ð·Ð°ÐºÐ°Ð·Ð¾Ð²:', error);
        res.status(500).json({ ok: false, error: error.message });
    }
});

// API Ð´Ð»Ñ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ ÐºÐ¾Ð½ÐºÑ€ÐµÑ‚Ð½Ð¾Ð³Ð¾ Ð·Ð°ÐºÐ°Ð·Ð°
app.get('/api/orders/:orderId', (req, res) => {
    try {
        const order = getOrder(req.params.orderId);
        if (order) {
            res.json({ ok: true, order });
        } else {
            res.status(404).json({ ok: false, error: 'Ð—Ð°ÐºÐ°Ð· Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½' });
        }
    } catch (error) {
        console.error('ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ Ð·Ð°ÐºÐ°Ð·Ð°:', error);
        res.status(500).json({ ok: false, error: error.message });
    }
});

// API Ð´Ð»Ñ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ ÑÑ‚Ð°Ñ‚ÑƒÑÐ° Ð·Ð°ÐºÐ°Ð·Ð°
app.put('/api/orders/:orderId/status', (req, res) => {
    try {
        const { status } = req.body;
        const orderId = req.params.orderId;
        
        // ðŸ”¥ ÐžÐ‘Ð ÐÐ‘ÐÐ¢Ð«Ð’ÐÐ•Ðœ Ð¡ÐŸÐ•Ð¦Ð˜ÐÐ›Ð¬ÐÐ«Ð• Ð¡Ð¢ÐÐ¢Ð£Ð¡Ð«
        if (status === 'cancelled' || status === 'expired') {
            // ÐžÑ‚Ð¼ÐµÐ½ÑÐµÐ¼ Ñ‚Ð°Ð¹Ð¼ÐµÑ€ Ð¿Ñ€Ð¸ Ñ€ÑƒÑ‡Ð½Ð¾Ð¹ Ð¾Ñ‚Ð¼ÐµÐ½Ðµ Ð¸Ð»Ð¸ Ð¸ÑÑ‚ÐµÑ‡ÐµÐ½Ð¸Ð¸ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸
            clearOrderTimer(orderId);
        }
        
        const order = updateOrderStatus(orderId, status);
        
        if (order) {
            console.log(`ðŸ“ Ð¡Ñ‚Ð°Ñ‚ÑƒÑ Ð·Ð°ÐºÐ°Ð·Ð° ${orderId} Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½ Ð½Ð°: ${status}`);
            res.json({ ok: true, order });
        } else {
            res.status(404).json({ ok: false, error: 'Ð—Ð°ÐºÐ°Ð· Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½' });
        }
    } catch (error) {
        console.error('ÐžÑˆÐ¸Ð±ÐºÐ° Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ ÑÑ‚Ð°Ñ‚ÑƒÑÐ°:', error);
        res.status(500).json({ ok: false, error: error.message });
    }
});

// Webhook Ð´Ð»Ñ Telegram
app.post('/api/telegram/webhook', (req, res) => {
    try {
        const { message, callback_query } = req.body;
        
        if (callback_query) {
            // ÐžÐ±Ñ€Ð°Ð±Ð°Ñ‚Ñ‹Ð²Ð°ÐµÐ¼ Ð½Ð°Ð¶Ð°Ñ‚Ð¸Ðµ Ð½Ð° inline-ÐºÐ½Ð¾Ð¿ÐºÑƒ
            handleCallbackQuery(callback_query);
        } else if (message) {
            // ÐžÐ±Ñ€Ð°Ð±Ð°Ñ‚Ñ‹Ð²Ð°ÐµÐ¼ Ð¾Ð±Ñ‹Ñ‡Ð½Ñ‹Ðµ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ
            console.log('ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¾ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ:', message.text);
        }
        
        res.json({ ok: true });
    } catch (error) {
        console.error('ÐžÑˆÐ¸Ð±ÐºÐ° Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸ Telegram webhook:', error);
        res.status(500).json({ ok: false, error: error.message });
    }
});

// Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸ callback query (Ð½Ð°Ð¶Ð°Ñ‚Ð¸Ñ Ð½Ð° ÐºÐ½Ð¾Ð¿ÐºÐ¸)
async function handleCallbackQuery(callbackQuery) {
    try {
        const { data, message, from } = callbackQuery;
        const [action, orderId] = data.split('_');
        
        console.log(`ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ: ${action} Ð´Ð»Ñ Ð·Ð°ÐºÐ°Ð·Ð° ${orderId}`);
        
        let order = getOrder(orderId);
        if (!order) {
            console.error(`Ð—Ð°ÐºÐ°Ð· ${orderId} Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½`);
            return;
        }
        
        let newStatus, statusText, statusEmoji;
        
        switch (action) {
            case 'accept':
                newStatus = 'accepted';
                statusText = 'ÐŸÑ€Ð¸Ð½ÑÑ‚';
                statusEmoji = 'ðŸŸ¡';
                break;
            case 'cancel':
                newStatus = 'cancelled';
                statusText = 'ÐžÑ‚Ð¼ÐµÐ½ÐµÐ½';
                statusEmoji = 'ðŸ”´';
                break;
            case 'preparing':
                newStatus = 'preparing';
                statusText = 'Ð“Ð¾Ñ‚Ð¾Ð²Ð¸Ñ‚ÑÑ';
                statusEmoji = 'ðŸ”µ';
                break;
            case 'delivering':
                newStatus = 'delivering';
                statusText = 'Ð’ Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐµ';
                statusEmoji = 'ðŸšš';
                break;
            case 'completed':
                newStatus = 'completed';
                statusText = 'Ð”Ð¾ÑÑ‚Ð°Ð²Ð»ÐµÐ½';
                statusEmoji = 'âœ…';
                break;
            default:
                console.error(`ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾Ðµ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ðµ: ${action}`);
                return;
        }
        
        // ÐžÐ±Ð½Ð¾Ð²Ð»ÑÐµÐ¼ ÑÑ‚Ð°Ñ‚ÑƒÑ Ð·Ð°ÐºÐ°Ð·Ð°
        order = updateOrderStatus(orderId, newStatus);
        
        // ÐžÐ±Ð½Ð¾Ð²Ð»ÑÐµÐ¼ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ Ð² Ð°Ð´Ð¼Ð¸Ð½-Ð³Ñ€ÑƒÐ¿Ð¿Ðµ
        await updateOrderMessage(message.chat.id, message.message_id, order, newStatus);
        
        // ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð»ÑÐµÐ¼ Ð¿Ð¾Ð´Ñ‚Ð²ÐµÑ€Ð¶Ð´ÐµÐ½Ð¸Ðµ
        await axios.post(`https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/answerCallbackQuery`, {
            callback_query_id: callbackQuery.id,
            text: `Ð¡Ñ‚Ð°Ñ‚ÑƒÑ Ð·Ð°ÐºÐ°Ð·Ð° #${orderId} Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½ Ð½Ð° "${statusText}"`
        });
        
        console.log(`Ð¡Ñ‚Ð°Ñ‚ÑƒÑ Ð·Ð°ÐºÐ°Ð·Ð° ${orderId} Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½ Ð½Ð° ${newStatus}`);
        
    } catch (error) {
        console.error('ÐžÑˆÐ¸Ð±ÐºÐ° Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸ callback query:', error);
    }
}

// Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ Ñ Ð·Ð°ÐºÐ°Ð·Ð¾Ð¼
async function updateOrderMessage(chatId, messageId, order, newStatus) {
    try {
        const statusEmojis = {
            'new': 'â³',
            'accepted': 'ðŸŸ¡',
            'preparing': 'ðŸ”µ',
            'delivering': 'ðŸšš',
            'completed': 'âœ…',
            'cancelled': 'ðŸ”´'
        };
        
        const statusTexts = {
            'new': 'ÐÐ¾Ð²Ñ‹Ð¹',
            'accepted': 'ÐŸÑ€Ð¸Ð½ÑÑ‚',
            'preparing': 'Ð“Ð¾Ñ‚Ð¾Ð²Ð¸Ñ‚ÑÑ',
            'delivering': 'Ð’ Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐµ',
            'completed': 'Ð”Ð¾ÑÑ‚Ð°Ð²Ð»ÐµÐ½',
            'cancelled': 'ÐžÑ‚Ð¼ÐµÐ½ÐµÐ½'
        };
        
        // Ð¤Ð¾Ñ€Ð¼Ð¸Ñ€ÑƒÐµÐ¼ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð½Ð¾Ðµ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ
        const message = `ðŸ†• Ð—ÐÐšÐÐ— #${order.id} - ${statusEmojis[newStatus]} ${statusTexts[newStatus]}

ðŸ‘¤ ${order.customerName || 'ÐšÐ»Ð¸ÐµÐ½Ñ‚'}
ðŸ“ ${order.address.street}, ${order.address.house}${order.address.apartment ? `, ÐºÐ².${order.address.apartment}` : ''} (${order.deliveryZone === 'moscow' ? 'ÐœÐ¾ÑÐºÐ²Ð°' : 'ÐœÐž'})
ðŸ’° ${order.totals?.total || 0}â‚½
ðŸ“¦ ${order.cartItems?.length || 0} Ñ‚Ð¾Ð²Ð°Ñ€Ð¾Ð²

ðŸ“‹ Ð¡Ð¾ÑÑ‚Ð°Ð² Ð·Ð°ÐºÐ°Ð·Ð°:
${order.cartItems.map(item => `â€¢ ${item.name} x${item.quantity} - ${item.price * item.quantity}â‚½`).join('\n')}

ðŸ“± Ð¢ÐµÐ»ÐµÑ„Ð¾Ð½: ${order.phone}
ðŸ’¬ ÐšÐ¾Ð¼Ð¼ÐµÐ½Ñ‚Ð°Ñ€Ð¸Ð¹: ${order.comment || 'Ð½ÐµÑ‚'}

[ðŸŸ¡ ÐŸÑ€Ð¸Ð½ÑÑ‚ÑŒ] [ðŸ”µ Ð“Ð¾Ñ‚Ð¾Ð²Ð¸Ñ‚ÑÑ] [ðŸšš Ð”Ð¾ÑÑ‚Ð°Ð²ÐºÐµ] [âœ… Ð”Ð¾ÑÑ‚Ð°Ð²Ð»ÐµÐ½]`;

        // Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð½Ñ‹Ðµ ÐºÐ½Ð¾Ð¿ÐºÐ¸ Ð² Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚Ð¸ Ð¾Ñ‚ ÑÑ‚Ð°Ñ‚ÑƒÑÐ°
        let inlineKeyboard;
        if (newStatus === 'new') {
            inlineKeyboard = {
                inline_keyboard: [
                    [
                        { text: 'ðŸŸ¡ ÐŸÑ€Ð¸Ð½ÑÑ‚ÑŒ', callback_data: `accept_${order.id}` },
                        { text: 'ðŸ”´ ÐžÑ‚Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ', callback_data: `cancel_${order.id}` }
                    ]
                ]
            };
        } else if (newStatus === 'accepted') {
            inlineKeyboard = {
                inline_keyboard: [
                    [
                        { text: 'ðŸ”µ Ð“Ð¾Ñ‚Ð¾Ð²Ð¸Ñ‚ÑÑ', callback_data: `preparing_${order.id}` },
                        { text: 'ðŸ”´ ÐžÑ‚Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ', callback_data: `cancel_${order.id}` }
                    ]
                ]
            };
        } else if (newStatus === 'preparing') {
            inlineKeyboard = {
                inline_keyboard: [
                    [
                        { text: 'ðŸšš Ð’ Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÑƒ', callback_data: `delivering_${order.id}` }
                    ]
                ]
            };
        } else if (newStatus === 'delivering') {
            inlineKeyboard = {
                inline_keyboard: [
                    [
                        { text: 'âœ… Ð”Ð¾ÑÑ‚Ð°Ð²Ð»ÐµÐ½', callback_data: `completed_${order.id}` }
                    ]
                ]
            };
        } else {
            // Ð”Ð»Ñ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð½Ñ‹Ñ… Ð¸Ð»Ð¸ Ð¾Ñ‚Ð¼ÐµÐ½ÐµÐ½Ð½Ñ‹Ñ… Ð·Ð°ÐºÐ°Ð·Ð¾Ð² ÑƒÐ±Ð¸Ñ€Ð°ÐµÐ¼ ÐºÐ½Ð¾Ð¿ÐºÐ¸
            inlineKeyboard = { inline_keyboard: [] };
        }
        
        // ÐžÐ±Ð½Ð¾Ð²Ð»ÑÐµÐ¼ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ
        await axios.post(`https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/editMessageText`, {
            chat_id: chatId,
            message_id: messageId,
            text: message,
            parse_mode: 'HTML',
            reply_markup: inlineKeyboard
        });
        
    } catch (error) {
        console.error('ÐžÑˆÐ¸Ð±ÐºÐ° Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ:', error);
    }
}

// Webhook Ð´Ð»Ñ Ð®Kassa
app.post('/api/yookassa/webhook', (req, res) => {
    try {
        const { event, object } = req.body;
        console.log('Ð®Kassa webhook received:', { event, object });
        
        if (event === 'payment.succeeded') {
            // ÐŸÐ»Ð°Ñ‚ÐµÐ¶ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ Ð¿Ñ€Ð¾Ð²ÐµÐ´ÐµÐ½
            handlePaymentSuccess(object);
        } else if (event === 'payment.canceled') {
            // ÐŸÐ»Ð°Ñ‚ÐµÐ¶ Ð¾Ñ‚Ð¼ÐµÐ½ÐµÐ½
            handlePaymentCanceled(object);
        }
        
        res.json({ ok: true });
    } catch (error) {
        console.error('ÐžÑˆÐ¸Ð±ÐºÐ° Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸ Ð®Kassa webhook:', error);
        res.status(500).json({ ok: false, error: error.message });
    }
});

// Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾Ð³Ð¾ Ð¿Ð»Ð°Ñ‚ÐµÐ¶Ð°
async function handlePaymentSuccess(payment) {
    try {
        const orderId = payment.metadata?.orderId;
        if (!orderId) {
            console.error('ÐÐµ Ð½Ð°Ð¹Ð´ÐµÐ½ orderId Ð² Ð¿Ð»Ð°Ñ‚ÐµÐ¶Ðµ');
            return;
        }
        
        const order = getOrder(orderId);
        if (!order) {
            console.error(`Ð—Ð°ÐºÐ°Ð· ${orderId} Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½`);
            return;
        }
        
        // ðŸ”¥ ÐžÐ¢ÐœÐ•ÐÐ¯Ð•Ðœ Ð¢ÐÐ™ÐœÐ•Ð  ÐÐ’Ð¢ÐžÐžÐ¢ÐœÐ•ÐÐ«
        cancelOrderTimer(orderId);
        
        // ÐžÐ±Ð½Ð¾Ð²Ð»ÑÐµÐ¼ ÑÑ‚Ð°Ñ‚ÑƒÑ Ð·Ð°ÐºÐ°Ð·Ð° Ð½Ð° "Ð¾Ð¿Ð»Ð°Ñ‡ÐµÐ½"
        order.paymentStatus = 'paid';
        order.paymentId = payment.id;
        order.updatedAt = new Date();
        orders.set(orderId, order);
        
        // ðŸ’¾ Ð¡ÐžÐ¥Ð ÐÐÐ¯Ð•Ðœ Ð’ Ð˜Ð¡Ð¢ÐžÐ Ð˜Ð® ÐŸÐžÐšÐ£ÐŸÐžÐš
        try {
            await PurchaseHistoryDB.create({
                orderId: order.id,
                userId: order.telegramUserId || order.userId || 'unknown',
                customerName: order.customerName,
                phone: order.phone,
                totalAmount: order.totals?.total || 0,
                itemsCount: order.cartItems?.length || 0,
                items: order.cartItems,
                paymentId: payment.id,
                purchaseDate: new Date(),
                deliveryZone: order.deliveryZone,
                address: order.address
            });
            console.log(`ðŸ’¾ ÐŸÐ¾ÐºÑƒÐ¿ÐºÐ° ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð° Ð² Ð¸ÑÑ‚Ð¾Ñ€Ð¸ÑŽ Ð´Ð»Ñ Ð·Ð°ÐºÐ°Ð·Ð° ${orderId}`);
        } catch (error) {
            console.error(`âŒ ÐžÑˆÐ¸Ð±ÐºÐ° ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ Ð¸ÑÑ‚Ð¾Ñ€Ð¸Ð¸ Ð¿Ð¾ÐºÑƒÐ¿ÐºÐ¸ ${orderId}:`, error);
        }
        
        // ðŸ—„ï¸ ÐžÐ‘ÐÐžÐ’Ð›Ð¯Ð•Ðœ Ð—ÐÐšÐÐ— Ð’ Ð‘Ð”
        try {
            await OrdersDB.update(orderId, order);
            console.log(`ðŸ’¾ Ð—Ð°ÐºÐ°Ð· ${orderId} Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½ Ð² Ð‘Ð”`);
        } catch (error) {
            console.error(`âŒ ÐžÑˆÐ¸Ð±ÐºÐ° Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ Ð·Ð°ÐºÐ°Ð·Ð° ${orderId} Ð² Ð‘Ð”:`, error);
        }
        
        // ðŸ”¥ Ð¢Ð•ÐŸÐ•Ð Ð¬ ÐžÐ¢ÐŸÐ ÐÐ’Ð›Ð¯Ð•Ðœ ÐŸÐžÐ›ÐÐžÐ• Ð£Ð’Ð•Ð”ÐžÐœÐ›Ð•ÐÐ˜Ð• Ð’ ÐÐ”ÐœÐ˜Ð Ð“Ð Ð£ÐŸÐŸÐ£
        if (TELEGRAM_BOT_TOKEN && TELEGRAM_ADMIN_CHAT_ID) {
            const totalAmount = order.totals?.total || 0;
            const itemsCount = order.cartItems?.length || 0;
            
            const message = `ðŸ’° ÐžÐŸÐ›ÐÐ§Ð•ÐÐÐ«Ð™ Ð—ÐÐšÐÐ— #${orderId}

ðŸ‘¤ ${order.customerName || 'ÐšÐ»Ð¸ÐµÐ½Ñ‚'}
ðŸ“ ${order.address.street}, ${order.address.house}${order.address.apartment ? `, ÐºÐ².${order.address.apartment}` : ''} (${order.deliveryZone === 'moscow' ? 'ÐœÐ¾ÑÐºÐ²Ð°' : 'ÐœÐž'})
ðŸ’° ${totalAmount}â‚½ âœ… ÐžÐŸÐ›ÐÐ§Ð•ÐÐž
ðŸ“¦ ${itemsCount} Ñ‚Ð¾Ð²Ð°Ñ€Ð¾Ð²

ðŸ“‹ Ð¡Ð¾ÑÑ‚Ð°Ð² Ð·Ð°ÐºÐ°Ð·Ð°:
${order.cartItems.map(item => `â€¢ ${item.name} x${item.quantity} - ${item.price * item.quantity}â‚½`).join('\n')}

ðŸ“± Ð¢ÐµÐ»ÐµÑ„Ð¾Ð½: ${order.phone}
ðŸ’¬ ÐšÐ¾Ð¼Ð¼ÐµÐ½Ñ‚Ð°Ñ€Ð¸Ð¹: ${order.comment || 'Ð½ÐµÑ‚'}

ðŸ’³ ID Ð¿Ð»Ð°Ñ‚ÐµÐ¶Ð°: ${payment.id}
â° Ð’Ñ€ÐµÐ¼Ñ Ð¾Ð¿Ð»Ð°Ñ‚Ñ‹: ${new Date().toLocaleString('ru-RU')}

Ð—Ð°ÐºÐ°Ð· Ð³Ð¾Ñ‚Ð¾Ð² Ðº Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸ÑŽ!`;

            // Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ ÐºÐ½Ð¾Ð¿ÐºÐ¸ Ð´Ð»Ñ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ Ð¾Ð¿Ð»Ð°Ñ‡ÐµÐ½Ð½Ñ‹Ð¼ Ð·Ð°ÐºÐ°Ð·Ð¾Ð¼
            const inlineKeyboard = {
                inline_keyboard: [
                    [
                        { text: 'ðŸŸ¡ ÐŸÑ€Ð¸Ð½ÑÑ‚ÑŒ', callback_data: `accept_${order.id}` },
                        { text: 'ðŸ”µ Ð“Ð¾Ñ‚Ð¾Ð²Ð¸Ñ‚ÑÑ', callback_data: `preparing_${order.id}` }
                    ]
                ]
            };
            
            await axios.post(`https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage`, {
                chat_id: TELEGRAM_ADMIN_CHAT_ID,
                text: message,
                parse_mode: 'HTML',
                reply_markup: inlineKeyboard
            });
        }
        
        console.log(`âœ… ÐŸÐ»Ð°Ñ‚ÐµÐ¶ Ð´Ð»Ñ Ð·Ð°ÐºÐ°Ð·Ð° ${orderId} Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚Ð°Ð½. Ð£Ð²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ðµ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¾ Ð°Ð´Ð¼Ð¸Ð½Ð°Ð¼.`);
        
    } catch (error) {
        console.error('ÐžÑˆÐ¸Ð±ÐºÐ° Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾Ð³Ð¾ Ð¿Ð»Ð°Ñ‚ÐµÐ¶Ð°:', error);
    }
}

// Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸ Ð¾Ñ‚Ð¼ÐµÐ½ÐµÐ½Ð½Ð¾Ð³Ð¾ Ð¿Ð»Ð°Ñ‚ÐµÐ¶Ð°
async function handlePaymentCanceled(payment) {
    try {
        const orderId = payment.metadata?.orderId;
        if (!orderId) {
            console.error('ÐÐµ Ð½Ð°Ð¹Ð´ÐµÐ½ orderId Ð² Ð¿Ð»Ð°Ñ‚ÐµÐ¶Ðµ');
            return;
        }
        
        const order = getOrder(orderId);
        if (!order) {
            console.error(`Ð—Ð°ÐºÐ°Ð· ${orderId} Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½`);
            return;
        }
        
        // ÐžÐ±Ð½Ð¾Ð²Ð»ÑÐµÐ¼ ÑÑ‚Ð°Ñ‚ÑƒÑ Ð·Ð°ÐºÐ°Ð·Ð°
        order.paymentStatus = 'canceled';
        order.updatedAt = new Date();
        orders.set(orderId, order);
        
        // ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð»ÑÐµÐ¼ ÑƒÐ²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ðµ Ð² Ð°Ð´Ð¼Ð¸Ð½-Ð³Ñ€ÑƒÐ¿Ð¿Ñƒ
        if (TELEGRAM_BOT_TOKEN && TELEGRAM_ADMIN_CHAT_ID) {
            const message = `âŒ ÐŸÐ›ÐÐ¢Ð•Ð– ÐžÐ¢ÐœÐ•ÐÐ•Ð!

ðŸ†• Ð—ÐÐšÐÐ— #${orderId}
ðŸ’³ ID Ð¿Ð»Ð°Ñ‚ÐµÐ¶Ð°: ${payment.id}
ðŸ’µ Ð¡ÑƒÐ¼Ð¼Ð°: ${payment.amount.value} ${payment.amount.currency}
âŒ Ð¡Ñ‚Ð°Ñ‚ÑƒÑ: ÐžÑ‚Ð¼ÐµÐ½ÐµÐ½

ÐšÐ»Ð¸ÐµÐ½Ñ‚ Ð¾Ñ‚Ð¼ÐµÐ½Ð¸Ð» Ð¾Ð¿Ð»Ð°Ñ‚Ñƒ Ð·Ð°ÐºÐ°Ð·Ð°.`;
            
            await axios.post(`https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage`, {
                chat_id: TELEGRAM_ADMIN_CHAT_ID,
                text: message,
                parse_mode: 'HTML'
            });
        }
        
        console.log(`ÐŸÐ»Ð°Ñ‚ÐµÐ¶ Ð´Ð»Ñ Ð·Ð°ÐºÐ°Ð·Ð° ${orderId} Ð¾Ñ‚Ð¼ÐµÐ½ÐµÐ½`);
        
    } catch (error) {
        console.error('ÐžÑˆÐ¸Ð±ÐºÐ° Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸ Ð¾Ñ‚Ð¼ÐµÐ½ÐµÐ½Ð½Ð¾Ð³Ð¾ Ð¿Ð»Ð°Ñ‚ÐµÐ¶Ð°:', error);
    }
}

// API Ð´Ð»Ñ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ Ð¿Ð»Ð°Ñ‚ÐµÐ¶Ð° Ñ‡ÐµÑ€ÐµÐ· Ð®Kassa
app.post('/api/payments/create', async (req, res) => {
    try {
        const { orderId, amount, description } = req.body;
        
        // ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ ÑÑƒÑ‰ÐµÑÑ‚Ð²Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð·Ð°ÐºÐ°Ð·Ð°
        const order = getOrder(orderId);
        if (!order) {
            return res.status(404).json({ ok: false, error: 'Ð—Ð°ÐºÐ°Ð· Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½' });
        }
        
        // Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ Ð¿Ð»Ð°Ñ‚ÐµÐ¶ Ð² Ð®Kassa
        const paymentData = {
            amount: {
                value: amount.toString(),
                currency: 'RUB'
            },
            capture: true,
            confirmation: {
                type: 'redirect',
                return_url: `${process.env.FRONTEND_URL || 'https://your-domain.com'}/payment-success`
            },
            description: description || `Ð—Ð°ÐºÐ°Ð· #${orderId}`,
            metadata: {
                orderId: orderId
            }
        };
        
        // Ð’ Ð¿Ñ€Ð¾Ð´Ð°ÐºÑˆÐµÐ½Ðµ Ð·Ð´ÐµÑÑŒ Ð±ÑƒÐ´ÐµÑ‚ Ñ€ÐµÐ°Ð»ÑŒÐ½Ñ‹Ð¹ Ð·Ð°Ð¿Ñ€Ð¾Ñ Ðº Ð®Kassa API
        // ÐŸÐ¾ÐºÐ° Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÐ¼ Ð·Ð°Ð³Ð»ÑƒÑˆÐºÑƒ
        const mockPayment = {
            id: `payment_${Date.now()}`,
            status: 'pending',
            confirmation_url: `https://yoomoney.ru/checkout/payments/v2/contract?orderId=${orderId}`,
            ...paymentData
        };
        
        res.json({ ok: true, payment: mockPayment });
        
    } catch (error) {
        console.error('ÐžÑˆÐ¸Ð±ÐºÐ° ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ Ð¿Ð»Ð°Ñ‚ÐµÐ¶Ð°:', error);
        res.status(500).json({ ok: false, error: error.message });
    }
});

// ðŸ”§ MIDDLEWARE Ð”Ð›Ð¯ Ð—ÐÐ©Ð˜Ð¢Ð« ÐÐ”ÐœÐ˜Ð API
function requireAdminAuth(req, res, next) {
    const providedPassword = req.headers['x-admin-password'] || req.query.password;
    const adminPassword = config.ADMIN_PASSWORD;
    
    if (providedPassword !== adminPassword) {
        return res.status(401).json({ 
            ok: false, 
            error: 'Unauthorized. Admin password required.' 
        });
    }
    
    next();
}

// ðŸ”§ API Ð”Ð›Ð¯ ÐžÐ¡ÐÐžÐ’ÐÐžÐ“Ðž ÐŸÐ Ð˜Ð›ÐžÐ–Ð•ÐÐ˜Ð¯

// ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ Ñ‚Ð¾Ð²Ð°Ñ€Ð¾Ð² Ð´Ð»Ñ Ð¾ÑÐ½Ð¾Ð²Ð½Ð¾Ð³Ð¾ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ (Ð¿ÑƒÐ±Ð»Ð¸Ñ‡Ð½Ñ‹Ð¹ API)
app.get('/api/products', async (req, res) => {
    try {
        // ðŸ—„ï¸ Ð—ÐÐ“Ð Ð£Ð–ÐÐ•Ðœ Ð˜Ð— Ð‘ÐÐ—Ð« Ð”ÐÐÐÐ«Ð¥
        let allProducts = await AdminProductsDB.loadAll();
        
        // Ð•ÑÐ»Ð¸ Ð² Ð‘Ð” Ð½ÐµÑ‚ Ñ‚Ð¾Ð²Ð°Ñ€Ð¾Ð², Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð¸Ð· Ð¿Ð°Ð¼ÑÑ‚Ð¸
        if (Object.keys(allProducts).length === 0 && adminProducts.size > 0) {
            allProducts = Object.fromEntries(adminProducts);
        }
        
        // Ð¤Ð¸Ð»ÑŒÑ‚Ñ€ÑƒÐµÐ¼ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹Ðµ Ñ‚Ð¾Ð²Ð°Ñ€Ñ‹ Ð´Ð»Ñ ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð¾Ð²
        const productsObj = {};
        for (const [categoryId, categoryProducts] of Object.entries(allProducts)) {
            const availableProducts = categoryProducts.filter(product => product.available !== false);
            if (availableProducts.length > 0) {
                productsObj[categoryId] = availableProducts;
            }
        }
        
        res.json({ ok: true, products: productsObj });
        
    } catch (error) {
        console.error('âŒ ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ Ñ‚Ð¾Ð²Ð°Ñ€Ð¾Ð²:', error);
        res.status(500).json({ ok: false, error: error.message });
    }
});

// ðŸ”§ API Ð”Ð›Ð¯ ÐÐ”ÐœÐ˜Ð ÐŸÐÐÐ•Ð›Ð˜

// ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ Ð²ÑÐµÑ… Ñ‚Ð¾Ð²Ð°Ñ€Ð¾Ð² Ð´Ð»Ñ Ð°Ð´Ð¼Ð¸Ð½ Ð¿Ð°Ð½ÐµÐ»Ð¸
app.get('/api/admin/products', requireAdminAuth, async (req, res) => {
    try {
        // ðŸ—„ï¸ Ð—ÐÐ“Ð Ð£Ð–ÐÐ•Ðœ Ð˜Ð— Ð‘ÐÐ—Ð« Ð”ÐÐÐÐ«Ð¥
        let products = await AdminProductsDB.loadAll();
        
        // ðŸ”„ Ð˜ÐÐ˜Ð¦Ð˜ÐÐ›Ð˜Ð—ÐÐ¦Ð˜Ð¯ Ð¢ÐžÐ›Ð¬ÐšÐž Ð•Ð¡Ð›Ð˜ Ð‘Ð” ÐŸÐžÐ›ÐÐžÐ¡Ð¢Ð¬Ð® ÐŸÐ£Ð¡Ð¢Ð (ÐŸÐ•Ð Ð’Ð«Ð™ Ð—ÐÐŸÐ£Ð¡Ðš)
        if (Object.keys(products).length === 0) {
            console.log('ðŸ”„ Ð‘Ð” Ð¿ÑƒÑÑ‚Ð°, Ð¸Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð¸Ñ€ÑƒÐµÐ¼ Ð¿Ð¾Ð»Ð½Ñ‹Ð¼ Ð°ÑÑÐ¾Ñ€Ñ‚Ð¸Ð¼ÐµÐ½Ñ‚Ð¾Ð¼ Ñ‚Ð¾Ð²Ð°Ñ€Ð¾Ð²...');
            
            // ÐŸÐ¾Ð»Ð½Ñ‹Ð¹ Ð°ÑÑÐ¾Ñ€Ñ‚Ð¸Ð¼ÐµÐ½Ñ‚ Ñ‚Ð¾Ð²Ð°Ñ€Ð¾Ð² (Ð²ÑÐµ 49 Ñ‚Ð¾Ð²Ð°Ñ€Ð¾Ð²)
            const fullProducts = await loadFullProductCatalog();
            
            // Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÑÐµÐ¼ Ð² Ð‘Ð” Ð¢ÐžÐ›Ð¬ÐšÐž ÐžÐ”Ð˜Ð Ð ÐÐ—
            try {
                await AdminProductsDB.saveAll(fullProducts);
                console.log('âœ… ÐŸÐ¾Ð»Ð½Ñ‹Ð¹ ÐºÐ°Ñ‚Ð°Ð»Ð¾Ð³ Ñ‚Ð¾Ð²Ð°Ñ€Ð¾Ð² ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½ Ð² Ð‘Ð” ÐŸÐ•Ð Ð’Ð«Ð™ Ð ÐÐ—');
                products = fullProducts;
                
                // Ð—Ð°Ð¿Ð¾Ð»Ð½ÑÐµÐ¼ Ð»Ð¾ÐºÐ°Ð»ÑŒÐ½Ñ‹Ð¹ ÐºÑÑˆ
                Object.entries(fullProducts).forEach(([categoryId, categoryProducts]) => {
                    adminProducts.set(categoryId, categoryProducts);
                });
            } catch (error) {
                console.error('âŒ ÐžÑˆÐ¸Ð±ÐºÐ° ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ Ð¿Ð¾Ð»Ð½Ð¾Ð³Ð¾ ÐºÐ°Ñ‚Ð°Ð»Ð¾Ð³Ð°:', error);
                products = fullProducts; // Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼ ÐºÐ°Ðº fallback
            }
        } else {
            // âœ… Ð˜Ð¡ÐŸÐžÐ›Ð¬Ð—Ð£Ð•Ðœ Ð¡ÐžÐ¥Ð ÐÐÐ•ÐÐÐ«Ð• Ð”ÐÐÐÐ«Ð• Ð˜Ð— Ð‘Ð” (Ñ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸ÑÐ¼Ð¸ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ)
            console.log('âœ… Ð—Ð°Ð³Ñ€ÑƒÐ¶ÐµÐ½Ñ‹ ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð½Ñ‹Ðµ Ñ‚Ð¾Ð²Ð°Ñ€Ñ‹ Ð¸Ð· Ð‘Ð” Ñ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒÑÐºÐ¸Ð¼Ð¸ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸ÑÐ¼Ð¸');
        }
        
        res.json({ ok: true, products });
    } catch (error) {
        console.error('ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ Ñ‚Ð¾Ð²Ð°Ñ€Ð¾Ð²:', error);
        res.status(500).json({ ok: false, error: error.message });
    }
});

// ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ Ñ‚Ð¾Ð²Ð°Ñ€Ð¾Ð² Ñ‡ÐµÑ€ÐµÐ· Ð°Ð´Ð¼Ð¸Ð½ Ð¿Ð°Ð½ÐµÐ»ÑŒ
app.put('/api/admin/products', requireAdminAuth, async (req, res) => {
    try {
        const { products } = req.body;
        
        // ðŸ—„ï¸ Ð¡ÐžÐ¥Ð ÐÐÐ¯Ð•Ðœ Ð’ Ð‘ÐÐ—Ð£ Ð”ÐÐÐÐ«Ð¥
        await AdminProductsDB.saveAll(products);
        
        // ÐžÐ±Ð½Ð¾Ð²Ð»ÑÐµÐ¼ Ð»Ð¾ÐºÐ°Ð»ÑŒÐ½Ñ‹Ð¹ ÐºÑÑˆ Ð´Ð»Ñ ÑÐ¾Ð²Ð¼ÐµÑÑ‚Ð¸Ð¼Ð¾ÑÑ‚Ð¸
        adminProducts.clear();
        Object.entries(products).forEach(([categoryId, categoryProducts]) => {
            adminProducts.set(categoryId, categoryProducts);
        });
        
        console.log('ðŸ”§ Ð¢Ð¾Ð²Ð°Ñ€Ñ‹ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ñ‹ Ñ‡ÐµÑ€ÐµÐ· Ð°Ð´Ð¼Ð¸Ð½ Ð¿Ð°Ð½ÐµÐ»ÑŒ Ð¸ ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ñ‹ Ð² Ð‘Ð”');
        res.json({ ok: true, message: 'Ð¢Ð¾Ð²Ð°Ñ€Ñ‹ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ñ‹ Ð¸ ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ñ‹ Ð² Ð±Ð°Ð·Ðµ Ð´Ð°Ð½Ð½Ñ‹Ñ…' });
        
    } catch (error) {
        console.error('âŒ ÐžÑˆÐ¸Ð±ÐºÐ° Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ Ñ‚Ð¾Ð²Ð°Ñ€Ð¾Ð²:', error);
        res.status(500).json({ ok: false, error: error.message });
    }
});

// ÐŸÐµÑ€ÐµÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð¾ÑÑ‚Ð¸ Ñ‚Ð¾Ð²Ð°Ñ€Ð°
app.patch('/api/admin/products/:categoryId/:productId/toggle', requireAdminAuth, async (req, res) => {
    try {
        const { categoryId, productId } = req.params;
        
        // ðŸ—„ï¸ Ð—ÐÐ“Ð Ð£Ð–ÐÐ•Ðœ Ð’Ð¡Ð• Ð¢ÐžÐ’ÐÐ Ð« Ð˜Ð— Ð‘Ð”
        let allProducts = await AdminProductsDB.loadAll();
        
        // Ð•ÑÐ»Ð¸ Ð² Ð‘Ð” Ð¿ÑƒÑÑ‚Ð¾, Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼ Ð¿Ð°Ð¼ÑÑ‚ÑŒ
        if (Object.keys(allProducts).length === 0) {
            allProducts = Object.fromEntries(adminProducts);
        }
        
        const categoryProducts = allProducts[categoryId];
        if (!categoryProducts) {
            return res.status(404).json({ ok: false, error: 'ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½Ð°' });
        }
        
        const product = categoryProducts.find(p => p.id === productId);
        if (!product) {
            return res.status(404).json({ ok: false, error: 'Ð¢Ð¾Ð²Ð°Ñ€ Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½' });
        }
        
        // ÐŸÐµÑ€ÐµÐºÐ»ÑŽÑ‡Ð°ÐµÐ¼ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð¾ÑÑ‚ÑŒ
        product.available = !product.available;
        
        // ðŸ’¾ Ð¡ÐžÐ¥Ð ÐÐÐ¯Ð•Ðœ Ð’Ð¡Ð• Ð¢ÐžÐ’ÐÐ Ð« ÐžÐ‘Ð ÐÐ¢ÐÐž Ð’ Ð‘Ð”
        await AdminProductsDB.saveAll(allProducts);
        
        // ÐžÐ±Ð½Ð¾Ð²Ð»ÑÐµÐ¼ Ð»Ð¾ÐºÐ°Ð»ÑŒÐ½Ñ‹Ð¹ ÐºÑÑˆ
        if (adminProducts.has(categoryId)) {
            const localProducts = adminProducts.get(categoryId);
            const localProduct = localProducts.find(p => p.id === productId);
            if (localProduct) {
                localProduct.available = product.available;
            }
        }
        
        console.log(`ðŸ”§ Ð¢Ð¾Ð²Ð°Ñ€ ${productId} ${product.available ? 'Ð¿Ð¾ÐºÐ°Ð·Ð°Ð½' : 'ÑÐºÑ€Ñ‹Ñ‚'} Ð¸ ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½ Ð² Ð‘Ð”`);
        res.json({ ok: true, product, available: product.available });
        
    } catch (error) {
        console.error('âŒ ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿ÐµÑ€ÐµÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ Ñ‚Ð¾Ð²Ð°Ñ€Ð°:', error);
        res.status(500).json({ ok: false, error: error.message });
    }
});

// SPA fallback - Ð²ÑÐµ Ð¾ÑÑ‚Ð°Ð»ÑŒÐ½Ñ‹Ðµ Ð¼Ð°Ñ€ÑˆÑ€ÑƒÑ‚Ñ‹ Ð²ÐµÐ´ÑƒÑ‚ Ð½Ð° index.html
app.get(/^\/(?!api).*/, (req, res) => {
    const requestedPath = req.path;
    
    // Ð•ÑÐ»Ð¸ Ð·Ð°Ð¿Ñ€Ð°ÑˆÐ¸Ð²Ð°ÐµÑ‚ÑÑ admin.html, Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ Ð¿Ð°Ñ€Ð¾Ð»ÑŒ
    if (requestedPath === '/admin' || requestedPath === '/admin.html') {
        const adminPassword = config.ADMIN_PASSWORD;
        const providedPassword = req.query.password;
        
        if (providedPassword !== adminPassword) {
            res.status(401).send(`
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ð’Ñ…Ð¾Ð´ Ð² Ð°Ð´Ð¼Ð¸Ð½ Ð¿Ð°Ð½ÐµÐ»ÑŒ</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
            background: linear-gradient(135deg, #0b5c56, #2C5530);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
        }
        .login-container {
            background: rgba(255,255,255,0.1);
            padding: 40px;
            border-radius: 20px;
            backdrop-filter: blur(10px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
            text-align: center;
            max-width: 400px;
            width: 90%;
        }
        .login-icon { font-size: 60px; margin-bottom: 20px; }
        .login-title { font-size: 28px; font-weight: 700; margin-bottom: 10px; }
        .login-subtitle { opacity: 0.9; margin-bottom: 30px; }
        .login-form { margin-top: 30px; }
        .login-input {
            width: 100%;
            padding: 15px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            margin-bottom: 20px;
            background: rgba(255,255,255,0.9);
            color: #2c3e50;
        }
        .login-btn {
            width: 100%;
            background: #D4A574;
            color: #1A1F2E;
            border: none;
            padding: 15px;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .login-btn:hover { background: #c19660; transform: translateY(-2px); }
        .error-msg {
            background: rgba(231, 76, 60, 0.2);
            color: #ff6b6b;
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 20px;
            border: 1px solid rgba(231, 76, 60, 0.3);
        }
    </style>
</head>
<body>
    <div class="login-container">
        <div class="login-icon">ðŸ”</div>
        <div class="login-title">ÐÐ´Ð¼Ð¸Ð½ Ð¿Ð°Ð½ÐµÐ»ÑŒ</div>
        <div class="login-subtitle">Tundra Gourmet</div>
        
        ${providedPassword ? '<div class="error-msg">âŒ ÐÐµÐ²ÐµÑ€Ð½Ñ‹Ð¹ Ð¿Ð°Ñ€Ð¾Ð»ÑŒ</div>' : ''}
        
        <form class="login-form" method="GET">
            <input type="password" 
                   name="password" 
                   class="login-input" 
                   placeholder="Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ð¿Ð°Ñ€Ð¾Ð»ÑŒ" 
                   required 
                   autofocus>
            <button type="submit" class="login-btn">ðŸš€ Ð’Ð¾Ð¹Ñ‚Ð¸</button>
        </form>
        
        <div style="margin-top: 30px; font-size: 14px; opacity: 0.7;">
            ðŸ’¡ Ð•ÑÐ»Ð¸ Ð·Ð°Ð±Ñ‹Ð»Ð¸ Ð¿Ð°Ñ€Ð¾Ð»ÑŒ, Ð¾Ð±Ñ€Ð°Ñ‚Ð¸Ñ‚ÐµÑÑŒ Ðº Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸ÐºÑƒ
        </div>
    </div>
</body>
</html>
            `);
            return;
        }
        
        res.sendFile(path.join(webRoot, 'admin.html'));
        return;
    }
    
    // ÐžÑÑ‚Ð°Ð»ÑŒÐ½Ñ‹Ðµ Ð¼Ð°Ñ€ÑˆÑ€ÑƒÑ‚Ñ‹ Ð²ÐµÐ´ÑƒÑ‚ Ð½Ð° Ð¾ÑÐ½Ð¾Ð²Ð½Ð¾Ðµ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ
    res.sendFile(path.join(webRoot, 'index.html'));
});

// Ð—Ð°Ð¿ÑƒÑÐº ÑÐµÑ€Ð²ÐµÑ€Ð° Ñ Ð¸Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸ÐµÐ¹ Ð‘Ð”
async function startServer() {
    try {
        // ðŸ—„ï¸ ÐŸÐ Ð˜ÐÐ£Ð”Ð˜Ð¢Ð•Ð›Ð¬ÐÐÐ¯ ÐžÐ§Ð˜Ð¡Ð¢ÐšÐ Ð‘Ð” (ÐµÑÐ»Ð¸ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð° Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ð°Ñ)
        if (process.env.CLEAR_DATABASE === 'true') {
            console.log('ðŸš¨ ÐŸÐ Ð˜ÐÐ£Ð”Ð˜Ð¢Ð•Ð›Ð¬ÐÐÐ¯ ÐžÐ§Ð˜Ð¡Ð¢ÐšÐ Ð‘ÐÐ—Ð« Ð”ÐÐÐÐ«Ð¥...');
            try {
                const { Pool } = require('pg');
                const pool = new Pool({ connectionString: config.DATABASE_URL });
                await pool.query('DELETE FROM admin_products');
                await pool.end();
                console.log('âœ… Ð¢Ð°Ð±Ð»Ð¸Ñ†Ð° admin_products Ð¾Ñ‡Ð¸Ñ‰ÐµÐ½Ð°');
            } catch (error) {
                console.error('âŒ ÐžÑˆÐ¸Ð±ÐºÐ° Ð¾Ñ‡Ð¸ÑÑ‚ÐºÐ¸ Ð‘Ð”:', error);
            }
        }
        
        // Ð˜Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð¸Ñ€ÑƒÐµÐ¼ Ð±Ð°Ð·Ñƒ Ð´Ð°Ð½Ð½Ñ‹Ñ…
        await initializeDatabase();
        
        // Ð—Ð°Ð³Ñ€ÑƒÐ¶Ð°ÐµÐ¼ Ñ‚Ð¾Ð²Ð°Ñ€Ñ‹ Ð¸Ð· Ð‘Ð” ÐµÑÐ»Ð¸ ÐµÑÑ‚ÑŒ
        try {
            const dbProducts = await AdminProductsDB.loadAll();
            if (Object.keys(dbProducts).length > 0) {
                console.log('âœ… Ð¢Ð¾Ð²Ð°Ñ€Ñ‹ Ð·Ð°Ð³Ñ€ÑƒÐ¶ÐµÐ½Ñ‹ Ð¸Ð· Ð±Ð°Ð·Ñ‹ Ð´Ð°Ð½Ð½Ñ‹Ñ…');
                // ÐŸÑ€ÐµÐ¾Ð±Ñ€Ð°Ð·ÑƒÐµÐ¼ Ð² Map Ð´Ð»Ñ ÑÐ¾Ð²Ð¼ÐµÑÑ‚Ð¸Ð¼Ð¾ÑÑ‚Ð¸ Ñ Ñ‚ÐµÐºÑƒÑ‰Ð¸Ð¼ ÐºÐ¾Ð´Ð¾Ð¼
                adminProducts.clear();
                for (const [categoryId, products] of Object.entries(dbProducts)) {
                    adminProducts.set(categoryId, products);
                }
            }
        } catch (error) {
            console.log('âš ï¸ Ð¢Ð¾Ð²Ð°Ñ€Ñ‹ Ð¸Ð· Ð‘Ð” Ð½Ðµ Ð·Ð°Ð³Ñ€ÑƒÐ¶ÐµÐ½Ñ‹, Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼ fallback');
        }
        
        // Ð—Ð°Ð¿ÑƒÑÐºÐ°ÐµÐ¼ ÑÐµÑ€Ð²ÐµÑ€
        app.listen(PORT, () => {
            console.log(`ðŸš€ Ð¡ÐµÑ€Ð²ÐµÑ€ Ð·Ð°Ð¿ÑƒÑ‰ÐµÐ½ Ð½Ð° Ð¿Ð¾Ñ€Ñ‚Ñƒ ${PORT}`);
            console.log(`ðŸ“ Ð¡Ñ‚Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ Ñ„Ð°Ð¹Ð»Ñ‹ Ð¸Ð·: ${webRoot}`);
            console.log(`ðŸ”— Health check: http://localhost:${PORT}/health`);
            console.log(`ðŸ—„ï¸ Ð‘Ð°Ð·Ð° Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð°`);
        });
        
    } catch (error) {
        console.error('âŒ ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð¿ÑƒÑÐºÐ° ÑÐµÑ€Ð²ÐµÑ€Ð°:', error);
        process.exit(1);
    }
}

startServer();

// Keep-alive Ð¼ÐµÑ…Ð°Ð½Ð¸Ð·Ð¼ Ð´Ð»Ñ Railway
setInterval(() => {
    const uptime = process.uptime();
    const memory = process.memoryUsage();
    console.log(`ðŸ’“ Keep-alive ping: ${new Date().toISOString()}, Uptime: ${Math.floor(uptime)}s, Memory: ${Math.round(memory.heapUsed / 1024 / 1024)}MB`);
}, 5 * 60 * 1000); // ÐšÐ°Ð¶Ð´Ñ‹Ðµ 5 Ð¼Ð¸Ð½ÑƒÑ‚

// Graceful shutdown
process.on('SIGTERM', () => {
    console.log('ðŸ›‘ ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½ ÑÐ¸Ð³Ð½Ð°Ð» SIGTERM, Ð·Ð°Ð²ÐµÑ€ÑˆÐ°ÐµÐ¼ Ñ€Ð°Ð±Ð¾Ñ‚Ñƒ...');
    process.exit(0);
});

process.on('SIGINT', () => {
    console.log('ðŸ›‘ ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½ ÑÐ¸Ð³Ð½Ð°Ð» SIGINT, Ð·Ð°Ð²ÐµÑ€ÑˆÐ°ÐµÐ¼ Ñ€Ð°Ð±Ð¾Ñ‚Ñƒ...');
    process.exit(0);
});
